
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>tfigure</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-03-17"><meta name="DC.source" content="tfigure.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">TFIGURE</a></li><li><a href="#3"><b>Properties</b></a></li><li><a href="#4"><b>Methods</b></a></li><li><a href="#5">TFIGURE([title_tab1]) Creates a new tabbed figure.</a></li><li><a href="#7">addTab([title])</a></li><li><a href="#9">addPlot([tab],'title',[title],'plotFcn',[function_handle])</a></li><li><a href="#11">addLabel Adds a label to the plot list</a></li><li><a href="#13">addCtrl([tab],[fun_handle(h_panel)],'title',[title])</a></li><li><a href="#15">addTable</a></li><li><a href="#17">savePPT</a></li></ul></div><pre class="codeinput"><span class="keyword">classdef</span> tfigure &lt; hgsetget
</pre><h2>TFIGURE<a name="2"></a></h2><p>A figure for holding tabbed groups of plots. Creates a tabbed plot figure.  This allows the user to setup tabs to group plots.  Each tab contains a list of plots that can be selected using buttons on the left of the figure.</p><pre class="language-matlab">Example
 h = tfigure;
 h = tfigure(<span class="string">'Tab_title'</span>);
</pre><p>tfigure Properties:  fig - Handle to the figure that displays tfigure.  tabs - Handles to each of the tfigure's tabs  figureSize - Current size of the figure containing tfigure</p><p>tfigure Methods:  tfigure - Constructs a new tabbed figure  addTab - Adds a new tab  addPlot - Adds a new plot to the given tab  savePPT - Saves all plots to a Power Point presentation.</p><p>Examples:  tFigExample - tfigure example</p><p>TO DO:</p><div><ul><li>Export Menu  * ppt, pictures, figures, copy image to clipboard  * Add support for using a ppt template</li><li>Control View   * Ability to add a button to the plot list to select a control    panel view in that tab.</li><li>Plot List    * Be able to add text Labels to group plots    * Be able to move plots up or down using mouse or a keyboard    shortcut    * Function to add a "Add Plot" button to the plot list GUI</li><li>Plot Context Menu    * uicontextmenu    * delete plot    * Reorder plot</li><li>Tab Bar    * "Add Tab" tab with a "+" label to create a new tab</li><li>Tab Context Menu    * change tab name using inputdlg function    * delete tab    * Reorder tab</li></ul></div><p>Author: Curtis Mayberry <a href="mailto:Curtisma3@gmail.com">Curtisma3@gmail.com</a> Curtisma.org</p><p>See Also: tFigExample</p><h2><b>Properties</b><a name="3"></a></h2><p>Class properties</p><pre class="codeinput">    properties
        fig <span class="comment">% Handle to the figure that displays tfigure.</span>
        tabs <span class="comment">% Handles to each of the tfigure's tabs</span>
        menu <span class="comment">% Tfigure menu</span>
    <span class="keyword">end</span>
    properties (Dependent)
        figureSize <span class="comment">% Current size of the figure containing tfigure</span>
    <span class="keyword">end</span>
    properties (Access = private)
        tabGroup
    <span class="keyword">end</span>
</pre><h2><b>Methods</b><a name="4"></a></h2><p>Class methods</p><pre class="codeinput">    methods
        <span class="keyword">function</span> obj = tfigure(varargin)
</pre><h2>TFIGURE([title_tab1]) Creates a new tabbed figure.<a name="5"></a></h2><pre>Additional tabs can be added to the figure using the addTab
function.  Plots can be added to each tab by using the addPlot
function.</pre><p>INPUTS  title_tab1 - The title of the first tab to be added. (optional)</p><p>see also: tFigExample</p><pre class="codeinput">        	obj.fig = figure(<span class="string">'Visible'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
                             <span class="string">'SizeChangedFcn'</span>,@obj.figResize,<span class="keyword">...</span>
                             <span class="string">'Interruptible'</span>,<span class="string">'off'</span>);
            obj.tabGroup = uitabgroup(<span class="string">'Parent'</span>, obj.fig);
            <span class="keyword">if</span>(nargin&gt;0)
                obj.addTab(varargin{1});
            <span class="keyword">else</span>
                obj.addTab;
            <span class="keyword">end</span>
<span class="comment">%             obj.menu = uimenu(obj.fig,'Label','Tfigure');</span>
            obj.menu = uimenu(obj.fig,<span class="string">'Label'</span>,<span class="string">'Export'</span>);
            uimenu(obj.menu,<span class="string">'Label'</span>,<span class="string">'Export PPT'</span>,<span class="string">'Callback'</span>,@obj.exportMenu)
            obj.fig.Visible = <span class="string">'on'</span>;
<span class="comment">%             h_add = obj.addTab('+');</span>
<span class="comment">%             h_add.ButtonDownFcn = @(x) obj.addTab([],'order',length(obj.tabs)-1);</span>
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> out = get.figureSize(obj)
            out = get(obj.fig,<span class="string">'position'</span>);
        <span class="keyword">end</span>
        <span class="keyword">function</span> set.figureSize(obj,val)
            set(obj.fig,<span class="string">'position'</span>,val);
        <span class="keyword">end</span>
        <span class="keyword">function</span> h = addTab(obj,varargin)
</pre><h2>addTab([title])<a name="7"></a></h2><p>Adds a new tab with the given title.</p><p>USAGE:  tfig.addTab(title);</p><pre class="codeinput">            p = inputParser;
            addOptional(p,<span class="string">'titleIn'</span>,<span class="keyword">...</span>
                        [<span class="string">'dataset '</span> num2str(length(obj.tabs)+1)],@isstr);
            p.addParameter(<span class="string">'order'</span>,[], <span class="keyword">...</span>
                             @(x) isnumeric(x) &amp;&amp; (x &gt;= 1) &amp;&amp; <span class="keyword">...</span>
                             (x &lt;= (length(obj.tabs)+1)))
            parse(p,varargin{:});
            order = p.Results.order;

            <span class="comment">% Setup tab</span>
            h = uitab(<span class="string">'Parent'</span>, obj.tabGroup,<span class="keyword">...</span>
                      <span class="string">'Title'</span>, p.Results.titleIn,<span class="string">'ButtonDownFcn'</span>,@obj.selectTab);

            <span class="comment">% Setup tab order</span>
            <span class="keyword">if</span>(isempty(order))
                obj.tabs(end+1) = h;
            <span class="keyword">else</span>
                obj.tabs((order+1):end+1) = obj.tabs(order:end);
                obj.tabs(order) = h;
                <span class="keyword">if</span>(order == 1)
                    obj.tabGroup.Children = obj.tabGroup.Children([end 1:end-1]);
                <span class="keyword">elseif</span>((order &gt; 1) &amp;&amp; (order &lt; length(obj.tabGroup.Children)))
                    obj.tabGroup.Children = obj.tabGroup.Children([1:(order-1) end (order):end-1]);
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="comment">% Setup tab context menu</span>
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Delete'</span>,<span class="string">'Callback'</span>,@obj.deleteDlg);

            <span class="comment">% Setup plot list</span>
            figSize = obj.figureSize;
            plotList = uibuttongroup(<span class="string">'parent'</span>,h,<span class="string">'Title'</span>,<span class="string">'Plots'</span>,<span class="keyword">...</span>
                            <span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                            <span class="string">'Position'</span>,[10 10  150 figSize(4)-45],<span class="keyword">...</span>
                            <span class="string">'tag'</span>,<span class="string">'plotList'</span>,<span class="keyword">...</span>
                            <span class="string">'SelectionChangedFcn'</span>,@obj.selectPlot);
            h.UserData = plotList;
            <span class="keyword">if</span>(length(plotList.Children) &lt;= 1)
                plotList.Visible = <span class="string">'off'</span>;
            <span class="keyword">end</span>
            <span class="comment">% Make the new tab current</span>
            obj.tabGroup.SelectedTab = h;
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> h = addPlot(obj,varargin)
</pre><h2>addPlot([tab],'title',[title],'plotFcn',[function_handle])<a name="9"></a></h2><p>Adds a plot to the given tab.  When the button is selected the plotting routine given by  plotFcn is ran.</p><pre class="codeinput">            p=inputParser;
            p.addOptional(<span class="string">'tab'</span>,obj.tabGroup.SelectedTab,@(x) (isa(x,<span class="string">'double'</span>) || isa(x,<span class="string">'matlab.ui.container.Tab'</span>) || ischar(x)))
            p.addParameter(<span class="string">'plotFcn'</span>,[],@(x) (isa(x,<span class="string">'function_handle'</span>) || isempty(x)));
            p.addParameter(<span class="string">'title'</span>,<span class="string">'plot'</span>,@ischar)
            p.addParameter(<span class="string">'order'</span>,[],@isnumeric);
            p.parse(varargin{:})

            <span class="comment">% Select the Tab</span>
            tab = obj.parseTab(p.Results.tab);

            <span class="comment">% Add the new plot to the plot list</span>
            plotList = get(tab,<span class="string">'UserData'</span>); <span class="comment">% The tab's UserData contains a handle to the uibuttongroup for the tab</span>
            h = uicontrol(<span class="string">'parent'</span>,plotList,<span class="keyword">...</span>
                          <span class="string">'Style'</span>, <span class="string">'togglebutton'</span>,<span class="keyword">...</span>
                          <span class="string">'String'</span>, p.Results.title,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                          <span class="string">'tag'</span>,<span class="string">'plot'</span>);

            <span class="comment">% Setup Context Menu</span>
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Delete'</span>,<span class="string">'Callback'</span>,@obj.deleteDlg);

            <span class="comment">% Setup Axes</span>
            h.UserData.fa = axes(<span class="string">'Parent'</span>,tab,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
<span class="keyword">...</span><span class="comment">%                              'position',axesSize,...</span>
                             <span class="string">'ActivePositionProperty'</span>,<span class="string">'OuterPosition'</span>);
            h.UserData.fa.Visible = <span class="string">'on'</span>;

            <span class="comment">% Setup order</span>
            order = p.Results.order;
            <span class="keyword">if</span>(isempty(order) || (order == length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:end 1]);
            <span class="keyword">elseif</span>((order &gt; 1) &amp;&amp; (order &lt; length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:(order-1) 1 (order):end]);
            <span class="keyword">end</span>

            <span class="keyword">if</span>(~isempty(p.Results.plotFcn))
                h.UserData.fh = p.Results.plotFcn;
                p.Results.plotFcn();
            <span class="keyword">end</span>
            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> h = addLabel(obj,title,varargin)
</pre><h2>addLabel Adds a label to the plot list<a name="11"></a></h2><p>USAGE:  h.addLabel(title,[tab],...)</p><pre class="codeinput">            p=inputParser;
            p.addRequired(<span class="string">'title'</span>,@ischar);
            p.addOptional(<span class="string">'tab'</span>,obj.tabGroup.SelectedTab,@(x) (isa(x,<span class="string">'double'</span>) || isa(x,<span class="string">'matlab.ui.container.Tab'</span>) || ischar(x)))
            p.addParameter(<span class="string">'plotFcn'</span>,[],@(x) (isa(x,<span class="string">'function_handle'</span>) || isempty(x)));
            p.addParameter(<span class="string">'order'</span>,[],@isnumeric);
            p.parse(title,varargin{:})

            <span class="comment">% Select the Tab</span>
            tab = obj.parseTab(p.Results.tab);

            <span class="comment">% Add the new label to the plot list</span>
            plotList = get(tab,<span class="string">'UserData'</span>); <span class="comment">% The tab's UserData contains a handle to the uibuttongroup for the tab</span>
            h = uicontrol(<span class="string">'parent'</span>,plotList,<span class="keyword">...</span>
                          <span class="string">'Style'</span>, <span class="string">'text'</span>,<span class="keyword">...</span>
                          <span class="string">'String'</span>, p.Results.title,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                          <span class="string">'tag'</span>,<span class="string">'label'</span>);

            <span class="comment">% Setup Context Menu</span>
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Delete'</span>,<span class="string">'Callback'</span>,@obj.deleteDlg);

            <span class="comment">% Setup order</span>
            order = p.Results.order;
            <span class="keyword">if</span>(isempty(order) || (order == length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:end 1]);
            <span class="keyword">elseif</span>((order &gt; 1) &amp;&amp; (order &lt; length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:(order-1) 1 (order):end]);
            <span class="keyword">end</span>
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> h = addCtrl(obj,varargin)
</pre><h2>addCtrl([tab],[fun_handle(h_panel)],'title',[title])<a name="13"></a></h2><p>Adds a control item to the given tab. When the button is selected the control panel given by fun_handle is displayed.</p><p>fun_handle has a single input that is a handle to the panel that will contain the control panel.</p><pre class="codeinput">            p=inputParser;
            p.addOptional(<span class="string">'tab'</span>,obj.tabGroup.SelectedTab,@(x) (isa(x,<span class="string">'double'</span>) || isa(x,<span class="string">'matlab.ui.container.Tab'</span>) || ischar(x)))
            p.addOptional(<span class="string">'fun_handle'</span>,[],@(x) isa(x,<span class="string">'function_handle'</span>));
            p.addParameter(<span class="string">'title'</span>,<span class="string">'Options'</span>,@ischar)
            p.addParameter(<span class="string">'order'</span>,[],@isnumeric);
            p.parse(varargin{:})

            <span class="comment">% Select the Tab</span>
            tab = obj.parseTab(p.Results.tab);

            <span class="comment">% Add the new control panel to the plot list</span>
            figSize = obj.figureSize;
            plotList = get(tab,<span class="string">'UserData'</span>); <span class="comment">% The tab's UserData contains a handle to the uibuttongroup for the tab</span>
            h = uicontrol(<span class="string">'parent'</span>,plotList,<span class="keyword">...</span>
                          <span class="string">'Style'</span>, <span class="string">'togglebutton'</span>,<span class="keyword">...</span>
                          <span class="string">'String'</span>, p.Results.title,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                          <span class="string">'tag'</span>,<span class="string">'ctrl'</span>);
            <span class="comment">% Setup Control Panel</span>
            h_panel = uipanel(<span class="string">'Parent'</span>,tab,<span class="keyword">...</span>
                              <span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                              <span class="string">'Position'</span>,[30 30  figSize(3)-30 figSize(4)-30],<span class="keyword">...</span>
                              <span class="string">'Title'</span>,p.Results.title);
            h.UserData.fa = h_panel;

            <span class="comment">% Setup Context Menu</span>
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Delete'</span>,<span class="string">'Callback'</span>,@obj.deleteDlg);
<span class="comment">%             h.UserData.fa = axes('Parent',tab,'Units','pixels',...</span>
<span class="comment">% ...%                              'position',axesSize,...</span>
<span class="comment">%                              'ActivePositionProperty','OuterPosition');</span>
<span class="comment">%             h.UserData.fa.Visible = 'on';</span>

            <span class="comment">% Setup order</span>
            order = p.Results.order;
            <span class="keyword">if</span>(isempty(order) || (order == length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:end 1]);
            <span class="keyword">elseif</span>((order &gt; 1) &amp;&amp; (order &lt; length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:(order-1) 1 (order):end]);
            <span class="keyword">end</span>


            <span class="keyword">if</span>(~isempty(p.Results.fun_handle))
                h.UserData.fh = p.Results.fun_handle;
                p.Results.fun_handle(h_panel);
            <span class="keyword">end</span>
            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> varargout = addTable(obj,varargin)
</pre><h2>addTable<a name="15"></a></h2><p>Adds a table to the given tab.</p><p>h.addTable([tab])</p><pre class="codeinput">            p=inputParser;
            p.addOptional(<span class="string">'tab'</span>,obj.tabGroup.SelectedTab,@(x) (isa(x,<span class="string">'double'</span>) || isa(x,<span class="string">'matlab.ui.container.Tab'</span>) || ischar(x)))
            p.addParameter(<span class="string">'title'</span>,<span class="string">'plot'</span>,@ischar)
            p.addParameter(<span class="string">'order'</span>,[],@isnumeric);
            p.parse(varargin{:})

            <span class="comment">% Select the Tab</span>
            tab = obj.parseTab(p.Results.tab);

            <span class="comment">% Add the new plot to the plot list</span>
            plotList = get(tab,<span class="string">'UserData'</span>); <span class="comment">% The tab's UserData contains a handle to the uibuttongroup for the tab</span>
            h = uicontrol(<span class="string">'parent'</span>,plotList,<span class="keyword">...</span>
                            <span class="string">'Style'</span>, <span class="string">'togglebutton'</span>,<span class="keyword">...</span>
                            <span class="string">'String'</span>, p.Results.title,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                            <span class="string">'tag'</span>,<span class="string">'table'</span>);
<span class="comment">%             h.UserData = p.Results.fun_handle;</span>

            <span class="comment">% Setup Context Menu</span>
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Delete'</span>,<span class="string">'Callback'</span>,@obj.deleteDlg);

            <span class="comment">% Setup Table</span>
            h.UserData.fa = uitable(<span class="string">'Parent'</span>,tab,<span class="string">'Units'</span>,<span class="string">'pixels'</span>);
            h.UserData.fa.Visible = <span class="string">'on'</span>;

            <span class="comment">% Setup order</span>
            order = p.Results.order;
            <span class="keyword">if</span>(isempty(order) || (order == length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:end 1]);
            <span class="keyword">elseif</span>((order &gt; 1) &amp;&amp; (order &lt; length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:(order-1) 1 (order):end]);
            <span class="keyword">end</span>

            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);

            <span class="comment">% Setup outputs</span>
            <span class="keyword">if</span>(nargout == 0)
                varargout = {};
            <span class="keyword">elseif</span>(nargout == 1)
                varargout = {h.UserData.fa};
            <span class="keyword">elseif</span>(nargout == 2)
                varargout = {h.UserData.fa h};
            <span class="keyword">else</span>
                error(<span class="string">'tfigure:addTable:nargoutWrong'</span>,<span class="string">'The number of outputs must be 0-2'</span>);
            <span class="keyword">end</span>
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> savePPT(obj,varargin)
</pre><h2>savePPT<a name="17"></a></h2><p>Saves all the plots in tfigure to a powerpoint presentation.</p><p>h.savePPT</p><pre class="codeinput">            <span class="keyword">if</span>(~(exist(<span class="string">'exportToPPTX'</span>,<span class="string">'file'</span>)))
               error(<span class="string">'tfigure:NeedExportToPPTX'</span>,<span class="keyword">...</span>
                     [<span class="string">'exportToPPTX must be added to the path. '</span>,<span class="keyword">...</span>
                     <span class="string">'It can be downloaded from the MATLAB file exchange'</span>]);
            <span class="keyword">end</span>
            <span class="keyword">if</span>(~isempty(obj.fig.Name))
                figTitle = obj.fig.Name;
            <span class="keyword">else</span>
                figTitle = [<span class="string">'Figure '</span> num2str(obj.fig.Number) <span class="string">' Data'</span>];
            <span class="keyword">end</span>
            p = inputParser;
            p.addOptional(<span class="string">'fileName'</span>,<span class="string">''</span>,@ischar);
            p.addParameter(<span class="string">'title'</span>,figTitle);
            p.addParameter(<span class="string">'author'</span>,<span class="string">''</span>);
            p.addParameter(<span class="string">'subject'</span>,<span class="string">''</span>);
            p.addParameter(<span class="string">'comments'</span>,<span class="string">''</span>);
            p.parse(varargin{:});
            <span class="keyword">if</span>(isempty(p.Results.fileName))
                [fileName,pathname] = uiputfile(<span class="string">'.pptx'</span>,<span class="string">'Export PPTX: select a file name'</span>);
                fileName = fullfile(pathname,fileName);
            <span class="keyword">else</span>
                fileName = p.Results.fileName;
            <span class="keyword">end</span>
            isOpen  = exportToPPTX();
            <span class="keyword">if</span> ~isempty(isOpen),
                <span class="comment">% If PowerPoint already started, then close first and then open a new one</span>
                exportToPPTX(<span class="string">'close'</span>);
            <span class="keyword">end</span>
            exportToPPTX(<span class="string">'new'</span>,<span class="keyword">...</span><span class="comment"> %'Dimensions',[12 6], ...</span>
                         <span class="string">'Title'</span>,p.Results.title, <span class="keyword">...</span>
                         <span class="string">'Author'</span>,p.Results.author, <span class="keyword">...</span>
                         <span class="string">'Subject'</span>,p.Results.subject, <span class="keyword">...</span>
                         <span class="string">'Comments'</span>,p.Results.comments);
            exportToPPTX(<span class="string">'addslide'</span>);
            exportToPPTX(<span class="string">'addtext'</span>,p.Results.title,<span class="keyword">...</span>
                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
                         <span class="string">'VerticalAlignment'</span>,<span class="string">'middle'</span>,<span class="string">'FontSize'</span>,48);
            numTabs = length(obj.tabs);
            summary = findobj(obj.tabs,<span class="string">'Title'</span>,<span class="string">'Summary'</span>);
            <span class="keyword">if</span>(~isempty(summary))
                startTab = 2;
            <span class="keyword">else</span>
                startTab = 1;
            <span class="keyword">end</span>
            <span class="keyword">for</span> tabNum = startTab:numTabs
                ht = get(obj.tabs(tabNum));
                hp = findobj(ht.Children,<span class="string">'tag'</span>,<span class="string">'plot'</span>);
                exportToPPTX(<span class="string">'addslide'</span>);
                exportToPPTX(<span class="string">'addtext'</span>,ht.Title,<span class="keyword">...</span>
                             <span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
                             <span class="string">'VerticalAlignment'</span>,<span class="string">'middle'</span>,<span class="string">'FontSize'</span>,48);
                <span class="keyword">for</span> plotNum = 1:length(hp)
                    h = figure(<span class="string">'Position'</span>,obj.fig.Position,<span class="keyword">...</span>
                               <span class="string">'Color'</span>,[1 1 1],<span class="string">'Visible'</span>,<span class="string">'off'</span>);
                    hp(plotNum).UserData();
                    exportToPPTX(<span class="string">'addslide'</span>);
                    exportToPPTX(<span class="string">'addpicture'</span>,h,<span class="string">'Scaled'</span>,<span class="string">'maxfixed'</span>);
                    close(h);
                <span class="keyword">end</span>
            <span class="keyword">end</span>
            exportToPPTX(<span class="string">'save'</span>,fileName);
            exportToPPTX(<span class="string">'close'</span>);
</pre><pre class="codeinput">        <span class="keyword">end</span>
    <span class="keyword">end</span>
    methods (Access = private)
        <span class="keyword">function</span> figResize(obj,src,~) <span class="comment">% callbackdata is unused 3rd arg.</span>
        <span class="comment">% figResize Resizes the gui elements in each tab whenever the</span>
        <span class="comment">%  figure is resized.</span>
            figSize = obj.figureSize;

            <span class="comment">% Set minimum figure size</span>
<span class="comment">%             if(figSize(3)&lt;560)</span>
<span class="comment">%                 figSize(3) = 560;</span>
<span class="comment">%             end</span>
<span class="comment">%             if(figSize(4)&lt;420)</span>
<span class="comment">%                 figSize(4) = 420;</span>
<span class="comment">%             end</span>
<span class="comment">%             obj.figureSize = figSize;</span>

            <span class="comment">% Find selected tab and plot</span>
            currTab = obj.tabGroup.SelectedTab;
            <span class="keyword">if</span>(~isempty(currTab.UserData.SelectedObject))
                currPlot = currTab.UserData.SelectedObject;
                currAxes = currPlot.UserData.fa;
                numPlots = length(currTab.UserData.Children);
            <span class="keyword">else</span>
                <span class="comment">%currPlot = [];</span>
                currAxes = [];
                numPlots = 0;
            <span class="keyword">end</span>

            <span class="comment">% Resize current axes</span>
            leg_pos = [0 0 0 0];
            <span class="keyword">if</span>(~isempty(currAxes) &amp;&amp; strcmp(currAxes.Type,<span class="string">'axes'</span>))
                <span class="comment">% Legend Adjustment</span>
                l = legend;
                <span class="keyword">if</span>(~isempty(l))
                    l.Units = <span class="string">'pixels'</span>;
                    leg_pos = l.Position;
                    set(currAxes,<span class="string">'ActivePositionProperty'</span>,<span class="string">'OuterPosition'</span>);
                <span class="keyword">end</span>
            <span class="keyword">end</span>
            <span class="comment">% Plot list adjustment</span>
            <span class="keyword">if</span>(numPlots==1)
                plotListAdj = [-160 0 150 0];
            <span class="keyword">else</span>
                plotListAdj = [0 0 0 0];
            <span class="keyword">end</span>

            <span class="comment">%Resize Current Axes</span>
            set(currAxes,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'Position'</span>,[210 50  figSize(3)-240 figSize(4)-110]<span class="keyword">...</span>
                                                   - [0 0 ceil(leg_pos(3)) 0]<span class="keyword">...</span><span class="comment"> % Legend Adjustment</span>
                                                   + plotListAdj); <span class="comment">% Plot list adjustment</span>
            <span class="comment">% Resize the plot list</span>
            plots = currTab.UserData.Children;
            <span class="keyword">for</span> n = 1:length(plots)
                set(plots(n),<span class="string">'Position'</span>,[10 figSize(4)-85-30*(n-1) 120 20]);
            <span class="keyword">end</span>

            <span class="comment">% Resize each list of plots</span>
            plotLists = findobj(src,<span class="string">'tag'</span>,<span class="string">'plotList'</span>,<span class="string">'-and'</span>,<span class="keyword">...</span>
                                <span class="string">'Type'</span>,<span class="string">'uibuttongroup'</span>);
            set(plotLists,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'Position'</span>,[10 10  150 figSize(4)-45])
<span class="comment">%             % Resize each axis</span>
<span class="comment">%             axesList = findobj(src,'Type','axes');</span>
<span class="comment">%             if(~isempty(axesList))</span>
<span class="comment">%                 l = legend;</span>
<span class="comment">%                 if(~isempty(l))</span>
<span class="comment">%                     l.Units = 'pixels';</span>
<span class="comment">%                     leg_pos = l.Position;</span>
<span class="comment">%                     set(axesList,'Units','pixels','Position',[210 50  figSize(3)-240 figSize(4)-110] - [0 0 ceil(leg_pos(3)) 0],'ActivePositionProperty','OuterPosition');</span>
<span class="comment">%                 else</span>
<span class="comment">%                     % TO DO: Add support for single plot tabs</span>
<span class="comment">%                     set(axesList,'Units','pixels','Position',[210 50  figSize(3)-240 figSize(4)-110],'ActivePositionProperty','OuterPosition');</span>
<span class="comment">%                 end</span>
<span class="comment">%             end</span>
<span class="comment">%             % Reposition plot buttons</span>
<span class="comment">%             for i_tab = 1:length(obj.tabs)</span>
<span class="comment">% %                 plots = findobj(obj.tabs(i_tab),'tag','plot','-and',...</span>
<span class="comment">% %                                 'Style','togglebutton');</span>
<span class="comment">%                 plots = get(get(obj.tabs(i_tab),'UserData'),'Children');</span>
<span class="comment">%                 for n = 1:length(plots)</span>
<span class="comment">%                     set(plots(n),'Position',[10 figSize(4)-85-30*(n-1) 120 20]);</span>
<span class="comment">%                 end</span>
<span class="comment">%             end</span>

        <span class="keyword">end</span>
        <span class="keyword">function</span> selectPlot(obj,src,~) <span class="comment">% ~ is obj and callbackdata</span>
        <span class="comment">% selectPlot Runs whenever a plot is selected from the plot list</span>
            <span class="keyword">if</span>(length(src.Children) &gt; 1)
                visible_plot = findobj(src.Parent.Children,<span class="string">'Visible'</span>,<span class="string">'on'</span>);
                <span class="keyword">for</span> i = 1:length(visible_plot)
                    visible_plot(i).Visible = <span class="string">'off'</span>;
                <span class="keyword">end</span>
                src.SelectedObject.UserData.fa.Visible = <span class="string">'on'</span>;
                <span class="comment">% Turn on plotted material</span>
                material = src.SelectedObject.UserData.fa.Children;
                <span class="keyword">if</span>(~isempty(material))
                    <span class="keyword">for</span> i = 1:length(material)
                        material(i).Visible = <span class="string">'on'</span>;
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                set(src.Children,<span class="string">'Visible'</span>,<span class="string">'on'</span>);
                src.Visible = <span class="string">'on'</span>;
<span class="comment">%                 for i = 1:length(src.Children)</span>
<span class="comment">%                       src.Children.</span>
<span class="comment">%                     src.Children(i).UserData.fa.Visible = 'off';</span>
<span class="comment">%                 end</span>
            <span class="keyword">else</span>
<span class="comment">%                 axesSize = [50 50 obj.figureSize(3)-90 obj.figureSize(4)-110];</span>
<span class="comment">%                 src.SelectedObject.UserData.fa.Position = axesSize;</span>
            <span class="keyword">end</span>
<span class="comment">%             if isa(src.SelectedObject.UserData, 'function_handle')</span>
<span class="comment">%                 axes(findobj(src.Parent,'Type','Axes'));</span>
<span class="comment">%                 src.SelectedObject.UserData(); % contains the plot function handle</span>
<span class="comment">%             elseif(isa(src.SelectedObject.UserData,'matlab.graphics.axis.Axes'))</span>
<span class="comment">%                 % Turn off current axes</span>
<span class="comment">%                 h_current = axes(findobj(src.Parent,'Type','Axes','-and',...</span>
<span class="comment">%                                          'Visible','on'));</span>
<span class="comment">%                 h_current.Visible = 'off';</span>
<span class="comment">%                 h_current.children.Visible = 'off';</span>
<span class="comment">%                 % Turn on new axes</span>
<span class="comment">% %                 h_new =</span>
<span class="comment">%             end</span>
            obj.figResize(obj.fig);
        <span class="keyword">end</span>
        <span class="keyword">function</span> selectTab(obj,~,~)
            obj.figResize(obj.fig);
        <span class="keyword">end</span>
        <span class="keyword">function</span> tab_out = parseTab(obj,tab)
        <span class="comment">% parseTab - parses a tab input, creating a new tab if the tab</span>
        <span class="comment">%  input is a tab name that doesn't exist.</span>
            <span class="keyword">if</span>(ischar(tab))
                tab_obj = findobj(tab,<span class="string">'Type'</span>,<span class="string">'tab'</span>);
                <span class="keyword">if</span>(isempty(tab_obj))
                    obj.addTab(tab)
                <span class="keyword">else</span>
                    tab_out = tab_obj;
                <span class="keyword">end</span>
            <span class="keyword">else</span>
                tab_out = tab;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">function</span> exportMenu(obj,menu,~)
        <span class="comment">% Export menu</span>
            <span class="keyword">if</span>(strcmp(menu.Label,<span class="string">'Export PPT'</span>))
                obj.savePPT();
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">function</span> renameDlg(~,menu,~) <span class="comment">% ~ is obj, ActionData</span>
        <span class="comment">% renameDlg Diaglog box for renaming plots and tabs from a context</span>
        <span class="comment">%  menu</span>
            type = get(menu.Parent.UserData,<span class="string">'Type'</span>);
            <span class="keyword">if</span>(strcmpi(type,<span class="string">'uicontrol'</span>))
                prevName = {menu.Parent.UserData.String};
                <span class="comment">% Get new name from the user</span>
                newName = inputdlg(<span class="string">'New Name:'</span>,<span class="string">'Rename'</span>,1,prevName);
                menu.Parent.UserData.String = newName{1};
            <span class="keyword">elseif</span>(strcmpi(type, <span class="string">'uitab'</span>))
                prevName = {menu.Parent.UserData.Title};
                <span class="comment">% Get new name from the user</span>
                newName = inputdlg(<span class="string">'New Name:'</span>,<span class="string">'Rename'</span>,1,prevName);
                menu.Parent.UserData.Title = newName{1};
            <span class="keyword">else</span>
                error(<span class="string">'tfigure:renameDlg:unknownSelectionType'</span>,<span class="keyword">...</span>
                      <span class="string">'unknown selection type, need to add ui type to be renamed to the callback function'</span>);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">function</span> deleteDlg(~,menu,~)
        <span class="comment">% deleteDlg function for deleting tabs and plots.  Double checks</span>
        <span class="comment">% with the user if a plot already exists.</span>
        <span class="comment">%  menu</span>
<span class="comment">%         delete();</span>
<span class="comment">%             type = get(menu.Parent.UserData,'Type');</span>
<span class="comment">%             if(strcmpi(type,'uicontrol'))</span>
<span class="comment">%</span>
<span class="comment">%             else</span>
<span class="comment">%</span>
<span class="comment">%             end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
classdef tfigure < hgsetget
    %% TFIGURE 
    % A figure for holding tabbed groups of plots.
    % Creates a tabbed plot figure.  This allows the user to setup tabs
    % to group plots.  Each tab contains a list of plots that can be
    % selected using buttons on the left of the figure.
    %    
    %   Example
    %    h = tfigure;
    %    h = tfigure('Tab_title');
    %
    % tfigure Properties:
    %  fig - Handle to the figure that displays tfigure.
    %  tabs - Handles to each of the tfigure's tabs
    %  figureSize - Current size of the figure containing tfigure
    %
    % tfigure Methods:
    %  tfigure - Constructs a new tabbed figure
    %  addTab - Adds a new tab
    %  addPlot - Adds a new plot to the given tab
    %  savePPT - Saves all plots to a Power Point presentation.
    %
    % Examples:
    %  tFigExample - tfigure example
    %
    % TO DO:
    %
    % * Export Menu
    %  * ppt, pictures, figures, copy image to clipboard
    %  * Add support for using a ppt template
    % * Control View
    %   * Ability to add a button to the plot list to select a control
    %    panel view in that tab.
    % * Plot List
    %    * Be able to add text Labels to group plots
    %    * Be able to move plots up or down using mouse or a keyboard
    %    shortcut
    %    * Function to add a "Add Plot" button to the plot list GUI
    % * Plot Context Menu
    %    * uicontextmenu
    %    * delete plot
    %    * Reorder plot
    % * Tab Bar
    %    * "Add Tab" tab with a "+" label to create a new tab
    % * Tab Context Menu
    %    * change tab name using inputdlg function
    %    * delete tab
    %    * Reorder tab
    %    
    % Author: Curtis Mayberry
    % Curtisma3@gmail.com
    % Curtisma.org
    %
    % See Also: tFigExample
    
    %% *Properties*
    % Class properties
    properties
        fig % Handle to the figure that displays tfigure.
        tabs % Handles to each of the tfigure's tabs
        menu % Tfigure menu
    end
    properties (Dependent)
        figureSize % Current size of the figure containing tfigure
    end
    properties (Access = private)
        tabGroup
    end
    %% *Methods*
    % Class methods
    methods
        function obj = tfigure(varargin)
        %% TFIGURE([title_tab1]) Creates a new tabbed figure.
        %  Additional tabs can be added to the figure using the addTab
        %  function.  Plots can be added to each tab by using the addPlot
        %  function.
        %
        % INPUTS
        %  title_tab1 - The title of the first tab to be added. (optional)
        %
        % see also: tFigExample
        %
        	obj.fig = figure('Visible','off',...
                             'SizeChangedFcn',@obj.figResize,...
                             'Interruptible','off'); 
            obj.tabGroup = uitabgroup('Parent', obj.fig);
            if(nargin>0)
                obj.addTab(varargin{1});
            else
                obj.addTab;
            end
%             obj.menu = uimenu(obj.fig,'Label','Tfigure');
            obj.menu = uimenu(obj.fig,'Label','Export');
            uimenu(obj.menu,'Label','Export PPT','Callback',@obj.exportMenu)
            obj.fig.Visible = 'on';
%             h_add = obj.addTab('+');
%             h_add.ButtonDownFcn = @(x) obj.addTab([],'order',length(obj.tabs)-1);
        end
        function out = get.figureSize(obj)
            out = get(obj.fig,'position');
        end
        function set.figureSize(obj,val)
            set(obj.fig,'position',val);
        end
        function h = addTab(obj,varargin)
        %% addTab([title]) 
        % Adds a new tab with the given title.
        %
        % USAGE:
        %  tfig.addTab(title);
        %
            p = inputParser;
            addOptional(p,'titleIn',...
                        ['dataset ' num2str(length(obj.tabs)+1)],@isstr);
            p.addParameter('order',[], ...
                             @(x) isnumeric(x) && (x >= 1) && ... 
                             (x <= (length(obj.tabs)+1)))
            parse(p,varargin{:});
            order = p.Results.order;
            
            % Setup tab
            h = uitab('Parent', obj.tabGroup,...
                      'Title', p.Results.titleIn,'ButtonDownFcn',@obj.selectTab);
            
            % Setup tab order
            if(isempty(order))
                obj.tabs(end+1) = h;
            else
                obj.tabs((order+1):end+1) = obj.tabs(order:end);
                obj.tabs(order) = h;
                if(order == 1)
                    obj.tabGroup.Children = obj.tabGroup.Children([end 1:end-1]);
                elseif((order > 1) && (order < length(obj.tabGroup.Children)))
                    obj.tabGroup.Children = obj.tabGroup.Children([1:(order-1) end (order):end-1]);
                end
            end
            
            % Setup tab context menu
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,'Label','Rename','Callback',@obj.renameDlg);
            uimenu(c,'Label','Delete','Callback',@obj.deleteDlg);
            
            % Setup plot list
            figSize = obj.figureSize;
            plotList = uibuttongroup('parent',h,'Title','Plots',...
                            'Units','pixels',...
                            'Position',[10 10  150 figSize(4)-45],...
                            'tag','plotList',...
                            'SelectionChangedFcn',@obj.selectPlot);
            h.UserData = plotList;
            if(length(plotList.Children) <= 1)
                plotList.Visible = 'off';
            end
            % Make the new tab current
            obj.tabGroup.SelectedTab = h;
        end
        function h = addPlot(obj,varargin)
        %% addPlot([tab],'title',[title],'plotFcn',[function_handle]) 
        % Adds a plot to the given tab.  
        %  When the button is selected the plotting routine given by
        %  plotFcn is ran.
        %  
            p=inputParser;
            p.addOptional('tab',obj.tabGroup.SelectedTab,@(x) (isa(x,'double') || isa(x,'matlab.ui.container.Tab') || ischar(x)))
            p.addParameter('plotFcn',[],@(x) (isa(x,'function_handle') || isempty(x)));
            p.addParameter('title','plot',@ischar)
            p.addParameter('order',[],@isnumeric);
            p.parse(varargin{:})
            
            % Select the Tab
            tab = obj.parseTab(p.Results.tab);
            
            % Add the new plot to the plot list
            plotList = get(tab,'UserData'); % The tab's UserData contains a handle to the uibuttongroup for the tab
            h = uicontrol('parent',plotList,...
                          'Style', 'togglebutton',...
                          'String', p.Results.title,'Units','pixels',...
                          'tag','plot');
                      
            % Setup Context Menu
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,'Label','Rename','Callback',@obj.renameDlg);
            uimenu(c,'Label','Delete','Callback',@obj.deleteDlg);
            
            % Setup Axes
            h.UserData.fa = axes('Parent',tab,'Units','pixels',...
...%                              'position',axesSize,...
                             'ActivePositionProperty','OuterPosition');
            h.UserData.fa.Visible = 'on';
            
            % Setup order
            order = p.Results.order;
            if(isempty(order) || (order == length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:end 1]);
            elseif((order > 1) && (order < length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:(order-1) 1 (order):end]);
            end
            
            if(~isempty(p.Results.plotFcn))
                h.UserData.fh = p.Results.plotFcn;
                p.Results.plotFcn();
            end
            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);
        end
        function h = addLabel(obj,title,varargin)
        %% addLabel Adds a label to the plot list
        %
        % USAGE:
        %  h.addLabel(title,[tab],...)
        %  
            p=inputParser;
            p.addRequired('title',@ischar);
            p.addOptional('tab',obj.tabGroup.SelectedTab,@(x) (isa(x,'double') || isa(x,'matlab.ui.container.Tab') || ischar(x)))
            p.addParameter('plotFcn',[],@(x) (isa(x,'function_handle') || isempty(x)));
            p.addParameter('order',[],@isnumeric);
            p.parse(title,varargin{:})
            
            % Select the Tab
            tab = obj.parseTab(p.Results.tab);
            
            % Add the new label to the plot list
            plotList = get(tab,'UserData'); % The tab's UserData contains a handle to the uibuttongroup for the tab
            h = uicontrol('parent',plotList,...
                          'Style', 'text',...
                          'String', p.Results.title,'Units','pixels',...
                          'tag','label');
            
            % Setup Context Menu
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,'Label','Rename','Callback',@obj.renameDlg);
            uimenu(c,'Label','Delete','Callback',@obj.deleteDlg);
            
            % Setup order
            order = p.Results.order;
            if(isempty(order) || (order == length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:end 1]);
            elseif((order > 1) && (order < length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:(order-1) 1 (order):end]);
            end
        end
        function h = addCtrl(obj,varargin)
        %% addCtrl([tab],[fun_handle(h_panel)],'title',[title]) 
        % Adds a control item to the given tab.  
        % When the button is selected the control panel given by
        % fun_handle is displayed.
        % 
        % fun_handle has a single input that is a handle to the panel that
        % will contain the control panel.
        %  
            p=inputParser;
            p.addOptional('tab',obj.tabGroup.SelectedTab,@(x) (isa(x,'double') || isa(x,'matlab.ui.container.Tab') || ischar(x)))
            p.addOptional('fun_handle',[],@(x) isa(x,'function_handle'));
            p.addParameter('title','Options',@ischar)
            p.addParameter('order',[],@isnumeric);
            p.parse(varargin{:})
            
            % Select the Tab
            tab = obj.parseTab(p.Results.tab);
            
            % Add the new control panel to the plot list
            figSize = obj.figureSize;
            plotList = get(tab,'UserData'); % The tab's UserData contains a handle to the uibuttongroup for the tab
            h = uicontrol('parent',plotList,...
                          'Style', 'togglebutton',...
                          'String', p.Results.title,'Units','pixels',...
                          'tag','ctrl');
            % Setup Control Panel
            h_panel = uipanel('Parent',tab,...
                              'Units','pixels',...
                              'Position',[30 30  figSize(3)-30 figSize(4)-30],...
                              'Title',p.Results.title);
            h.UserData.fa = h_panel;
            
            % Setup Context Menu
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,'Label','Rename','Callback',@obj.renameDlg);
            uimenu(c,'Label','Delete','Callback',@obj.deleteDlg);
%             h.UserData.fa = axes('Parent',tab,'Units','pixels',...
% ...%                              'position',axesSize,...
%                              'ActivePositionProperty','OuterPosition');
%             h.UserData.fa.Visible = 'on';           

            % Setup order
            order = p.Results.order;
            if(isempty(order) || (order == length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:end 1]);
            elseif((order > 1) && (order < length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:(order-1) 1 (order):end]);
            end


            if(~isempty(p.Results.fun_handle))
                h.UserData.fh = p.Results.fun_handle;
                p.Results.fun_handle(h_panel);
            end
            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);
        end
        function varargout = addTable(obj,varargin)
        %% addTable 
        % Adds a table to the given tab.
        %
        % h.addTable([tab])
        %
        %
            p=inputParser;
            p.addOptional('tab',obj.tabGroup.SelectedTab,@(x) (isa(x,'double') || isa(x,'matlab.ui.container.Tab') || ischar(x)))
            p.addParameter('title','plot',@ischar)
            p.addParameter('order',[],@isnumeric);
            p.parse(varargin{:})
            
            % Select the Tab
            tab = obj.parseTab(p.Results.tab);
            
            % Add the new plot to the plot list
            plotList = get(tab,'UserData'); % The tab's UserData contains a handle to the uibuttongroup for the tab
            h = uicontrol('parent',plotList,...
                            'Style', 'togglebutton',...
                            'String', p.Results.title,'Units','pixels',...
                            'tag','table');
%             h.UserData = p.Results.fun_handle;
            
            % Setup Context Menu
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,'Label','Rename','Callback',@obj.renameDlg);
            uimenu(c,'Label','Delete','Callback',@obj.deleteDlg);
            
            % Setup Table
            h.UserData.fa = uitable('Parent',tab,'Units','pixels');
            h.UserData.fa.Visible = 'on';   
            
            % Setup order
            order = p.Results.order;
            if(isempty(order) || (order == length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:end 1]);
            elseif((order > 1) && (order < length(obj.tabGroup.Children)))
                plotList.Children = plotList.Children([2:(order-1) 1 (order):end]);
            end
            
            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);
            
            % Setup outputs
            if(nargout == 0)
                varargout = {};
            elseif(nargout == 1)
                varargout = {h.UserData.fa};
            elseif(nargout == 2)
                varargout = {h.UserData.fa h};
            else
                error('tfigure:addTable:nargoutWrong','The number of outputs must be 0-2');
            end
        end
        function savePPT(obj,varargin)
        %% savePPT 
        % Saves all the plots in tfigure to a powerpoint presentation.  
        % 
        % h.savePPT
        %
            if(~(exist('exportToPPTX','file')))
               error('tfigure:NeedExportToPPTX',...
                     ['exportToPPTX must be added to the path. ',...
                     'It can be downloaded from the MATLAB file exchange']);
            end
            if(~isempty(obj.fig.Name))
                figTitle = obj.fig.Name;
            else
                figTitle = ['Figure ' num2str(obj.fig.Number) ' Data'];
            end
            p = inputParser;
            p.addOptional('fileName','',@ischar);
            p.addParameter('title',figTitle);
            p.addParameter('author','');
            p.addParameter('subject','');
            p.addParameter('comments','');
            p.parse(varargin{:});
            if(isempty(p.Results.fileName))
                [fileName,pathname] = uiputfile('.pptx','Export PPTX: select a file name');
                fileName = fullfile(pathname,fileName);
            else
                fileName = p.Results.fileName;
            end
            isOpen  = exportToPPTX();
            if ~isempty(isOpen),
                % If PowerPoint already started, then close first and then open a new one
                exportToPPTX('close');
            end
            exportToPPTX('new',... %'Dimensions',[12 6], ...
                         'Title',p.Results.title, ...
                         'Author',p.Results.author, ...
                         'Subject',p.Results.subject, ...
                         'Comments',p.Results.comments);
            exportToPPTX('addslide');
            exportToPPTX('addtext',p.Results.title,...
                         'HorizontalAlignment','center',...
                         'VerticalAlignment','middle','FontSize',48);
            numTabs = length(obj.tabs);
            summary = findobj(obj.tabs,'Title','Summary');
            if(~isempty(summary))
                startTab = 2;
            else
                startTab = 1;
            end
            for tabNum = startTab:numTabs
                ht = get(obj.tabs(tabNum));
                hp = findobj(ht.Children,'tag','plot');
                exportToPPTX('addslide');
                exportToPPTX('addtext',ht.Title,...
                             'HorizontalAlignment','center',...
                             'VerticalAlignment','middle','FontSize',48);
                for plotNum = 1:length(hp)
                    h = figure('Position',obj.fig.Position,...
                               'Color',[1 1 1],'Visible','off');
                    hp(plotNum).UserData();
                    exportToPPTX('addslide');
                    exportToPPTX('addpicture',h,'Scaled','maxfixed');
                    close(h);
                end
            end
            exportToPPTX('save',fileName);
            exportToPPTX('close');
        end
    end
    methods (Access = private)
        function figResize(obj,src,~) % callbackdata is unused 3rd arg.
        % figResize Resizes the gui elements in each tab whenever the 
        %  figure is resized. 
            figSize = obj.figureSize;
            
            % Set minimum figure size
%             if(figSize(3)<560)
%                 figSize(3) = 560;
%             end
%             if(figSize(4)<420)
%                 figSize(4) = 420;
%             end
%             obj.figureSize = figSize;
            
            % Find selected tab and plot
            currTab = obj.tabGroup.SelectedTab;
            if(~isempty(currTab.UserData.SelectedObject))
                currPlot = currTab.UserData.SelectedObject;
                currAxes = currPlot.UserData.fa;
                numPlots = length(currTab.UserData.Children);
            else
                %currPlot = [];
                currAxes = [];
                numPlots = 0;
            end
            
            % Resize current axes
            leg_pos = [0 0 0 0];
            if(~isempty(currAxes) && strcmp(currAxes.Type,'axes'))
                % Legend Adjustment
                l = legend;
                if(~isempty(l))
                    l.Units = 'pixels';
                    leg_pos = l.Position;
                    set(currAxes,'ActivePositionProperty','OuterPosition');
                end
            end
            % Plot list adjustment
            if(numPlots==1)
                plotListAdj = [-160 0 150 0];
            else
                plotListAdj = [0 0 0 0];
            end

            %Resize Current Axes
            set(currAxes,'Units','pixels','Position',[210 50  figSize(3)-240 figSize(4)-110]...
                                                   - [0 0 ceil(leg_pos(3)) 0]... % Legend Adjustment
                                                   + plotListAdj); % Plot list adjustment
            % Resize the plot list
            plots = currTab.UserData.Children;
            for n = 1:length(plots)
                set(plots(n),'Position',[10 figSize(4)-85-30*(n-1) 120 20]);
            end

            % Resize each list of plots
            plotLists = findobj(src,'tag','plotList','-and',...
                                'Type','uibuttongroup');
            set(plotLists,'Units','pixels','Position',[10 10  150 figSize(4)-45])
%             % Resize each axis
%             axesList = findobj(src,'Type','axes');
%             if(~isempty(axesList))
%                 l = legend;
%                 if(~isempty(l))
%                     l.Units = 'pixels';
%                     leg_pos = l.Position;
%                     set(axesList,'Units','pixels','Position',[210 50  figSize(3)-240 figSize(4)-110] - [0 0 ceil(leg_pos(3)) 0],'ActivePositionProperty','OuterPosition');
%                 else
%                     % TO DO: Add support for single plot tabs
%                     set(axesList,'Units','pixels','Position',[210 50  figSize(3)-240 figSize(4)-110],'ActivePositionProperty','OuterPosition');
%                 end
%             end
%             % Reposition plot buttons
%             for i_tab = 1:length(obj.tabs)
% %                 plots = findobj(obj.tabs(i_tab),'tag','plot','-and',...
% %                                 'Style','togglebutton');
%                 plots = get(get(obj.tabs(i_tab),'UserData'),'Children');
%                 for n = 1:length(plots)
%                     set(plots(n),'Position',[10 figSize(4)-85-30*(n-1) 120 20]);
%                 end
%             end
            
        end
        function selectPlot(obj,src,~) % ~ is obj and callbackdata          
        % selectPlot Runs whenever a plot is selected from the plot list
            if(length(src.Children) > 1)
                visible_plot = findobj(src.Parent.Children,'Visible','on');
                for i = 1:length(visible_plot)
                    visible_plot(i).Visible = 'off';
                end
                src.SelectedObject.UserData.fa.Visible = 'on';
                % Turn on plotted material 
                material = src.SelectedObject.UserData.fa.Children;
                if(~isempty(material))
                    for i = 1:length(material)
                        material(i).Visible = 'on';
                    end
                end
                set(src.Children,'Visible','on');
                src.Visible = 'on';
%                 for i = 1:length(src.Children)
%                       src.Children.
%                     src.Children(i).UserData.fa.Visible = 'off';
%                 end
            else
%                 axesSize = [50 50 obj.figureSize(3)-90 obj.figureSize(4)-110];
%                 src.SelectedObject.UserData.fa.Position = axesSize;
            end
%             if isa(src.SelectedObject.UserData, 'function_handle')
%                 axes(findobj(src.Parent,'Type','Axes'));
%                 src.SelectedObject.UserData(); % contains the plot function handle
%             elseif(isa(src.SelectedObject.UserData,'matlab.graphics.axis.Axes'))
%                 % Turn off current axes
%                 h_current = axes(findobj(src.Parent,'Type','Axes','-and',...
%                                          'Visible','on'));
%                 h_current.Visible = 'off';
%                 h_current.children.Visible = 'off';
%                 % Turn on new axes
% %                 h_new = 
%             end
            obj.figResize(obj.fig);
        end
        function selectTab(obj,~,~)
            obj.figResize(obj.fig);
        end
        function tab_out = parseTab(obj,tab)
        % parseTab - parses a tab input, creating a new tab if the tab
        %  input is a tab name that doesn't exist.
            if(ischar(tab))
                tab_obj = findobj(tab,'Type','tab');
                if(isempty(tab_obj))
                    obj.addTab(tab)
                else
                    tab_out = tab_obj;
                end
            else
                tab_out = tab;
            end
        end
        function exportMenu(obj,menu,~)
        % Export menu
            if(strcmp(menu.Label,'Export PPT'))
                obj.savePPT();
            end
        end    
        function renameDlg(~,menu,~) % ~ is obj, ActionData
        % renameDlg Diaglog box for renaming plots and tabs from a context
        %  menu
            type = get(menu.Parent.UserData,'Type');
            if(strcmpi(type,'uicontrol'))
                prevName = {menu.Parent.UserData.String};
                % Get new name from the user
                newName = inputdlg('New Name:','Rename',1,prevName);
                menu.Parent.UserData.String = newName{1};
            elseif(strcmpi(type, 'uitab'))
                prevName = {menu.Parent.UserData.Title};
                % Get new name from the user
                newName = inputdlg('New Name:','Rename',1,prevName);
                menu.Parent.UserData.Title = newName{1};
            else
                error('tfigure:renameDlg:unknownSelectionType',...
                      'unknown selection type, need to add ui type to be renamed to the callback function');
            end
        end
        function deleteDlg(~,menu,~)
        % deleteDlg function for deleting tabs and plots.  Double checks
        % with the user if a plot already exists.
        %  menu
%         delete();
%             type = get(menu.Parent.UserData,'Type');
%             if(strcmpi(type,'uicontrol'))
%                 
%             else
%                 
%             end
        end
    end
end


##### SOURCE END #####
--></body></html>