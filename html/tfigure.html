
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>tfigure</title><meta name="generator" content="MATLAB 9.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-06-26"><meta name="DC.source" content="tfigure.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">TFIGURE</a></li><li><a href="#3"><b>Properties</b></a></li><li><a href="#4"><b>Methods</b></a></li><li><a href="#5">TFIGURE([title_tab1]) Creates a new tabbed figure.</a></li><li><a href="#7">addTab</a></li><li><a href="#9">addPlot</a></li><li><a href="#11">addTable</a></li><li><a href="#13">addLabel Adds a label to the plot list</a></li><li><a href="#15">addCtrl</a></li><li><a href="#17">exportToClipboard</a></li><li><a href="#19">savePPT</a></li></ul></div><pre class="codeinput"><span class="keyword">classdef</span> tfigure &lt; hgsetget
</pre><h2>TFIGURE<a name="2"></a></h2><p>A figure for holding tabbed groups of plots. Creates a tabbed plot figure.  This allows the user to setup tabs to group plots.  Each tab contains a list of plots that can be selected using buttons on the left of the figure.</p><p>Example  h = tfigure;  h = tfigure('Tab_title');</p><p>tfigure Properties:  fig - Handle to the figure that displays tfigure.  tabs - Handles to each of the tfigure's tabs  figureSize - Current size of the figure containing tfigure  gct - get current tab  gcp - get current panel</p><p>tfigure Methods:  tfigure - Constructs a new tabbed figure  addTab - Adds a new tab  addPlot - Adds a new plot to the given tab  addTable - Adds a table to the plot list  addLabel - Adds a label to the plot list  addCtrl - Adds a control panel to the plot list  savePPT - Saves all plots to a Power Point presentation.</p><p>Examples:  tFigExample - tfigure example</p><p>SETUP:  Files that can be downloaded from the MATLAB file exchange  exportToPPTX - Required to export to a pptx presentation   <a href="https://www.mathworks.com/matlabcentral/fileexchange/40277-exporttopptx">https://www.mathworks.com/matlabcentral/fileexchange/40277-exporttopptx</a></p><p>See issues in Github: <a href="https://github.com/curtisma/MATLAB_tfigure/issues">https://github.com/curtisma/MATLAB_tfigure/issues</a></p><p>Author: Curtis Mayberry <a href="mailto:Curtisma3@gmail.com">Curtisma3@gmail.com</a> Curtisma.org</p><p>See Also: tFigExample, tfigure.tfigure</p><h2><b>Properties</b><a name="3"></a></h2><p>Class properties</p><pre class="codeinput">    properties
        fig <span class="comment">% Handle to the figure that displays tfigure.</span>
<span class="comment">%         tabs % Handles to each of the tfigure's tabs</span>
        menu <span class="comment">% Tfigure menu</span>
    <span class="keyword">end</span>
    properties (Dependent)
        tabs <span class="comment">% Handles to each of the tfigure's tabs</span>
        figureSize <span class="comment">% Current size of the figure containing tfigure</span>
        gct <span class="comment">% Get Current Tab</span>
        gcp <span class="comment">% Get Current Panel</span>
    <span class="keyword">end</span>
    properties (Access = private)
        tabGroup
    <span class="keyword">end</span>
</pre><h2><b>Methods</b><a name="4"></a></h2><p>Class methods</p><pre class="codeinput">    methods
        <span class="keyword">function</span> obj = tfigure(varargin)
</pre><h2>TFIGURE([title_tab1]) Creates a new tabbed figure.<a name="5"></a></h2><pre>Additional tabs can be added to the figure using the addTab
function.  Plots can be added to each tab by using the addPlot
function.</pre><pre>h = tfigure;
 Creates a tfigure object
h2 = tfigure('Data Tab #1');
 Creates a tfigure object with "Data Tab #1" as the tab title.</pre><p>INPUTS  title_tab1 - (optional) The title of the first tab to be added. OUTPUTS  h - a tfigure object</p><p>see also: tFigExample</p><pre class="codeinput">        	obj.fig = figure(<span class="string">'Visible'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
                             <span class="string">'SizeChangedFcn'</span>,@obj.figResize,<span class="keyword">...</span>
                             <span class="string">'Interruptible'</span>,<span class="string">'off'</span>);
            obj.tabGroup = uitabgroup(<span class="string">'Parent'</span>, obj.fig);
            <span class="keyword">if</span>(nargin&gt;0)
                obj.addTab(varargin{:});
            <span class="keyword">else</span>
                obj.addTab;
            <span class="keyword">end</span>
<span class="comment">%             obj.menu = uimenu(obj.fig,'Label','Tfigure');</span>
            obj.menu = uimenu(obj.fig,<span class="string">'Label'</span>,<span class="string">'Export'</span>);
            uimenu(obj.menu,<span class="string">'Label'</span>,<span class="string">'Export PPT'</span>,<span class="string">'Callback'</span>,@obj.exportMenu)
            uimenu(obj.menu,<span class="string">'Label'</span>,<span class="string">'Copy Panel to Clipboard'</span>,<span class="string">'Callback'</span>,@obj.exportToClipboard);

            uitab(<span class="string">'Parent'</span>, obj.tabGroup,<span class="string">'Title'</span>,<span class="string">'+'</span>,<span class="keyword">...</span>
                  <span class="string">'ButtonDownFcn'</span>,@obj.addTab,<span class="string">'TooltipString'</span>,<span class="string">'Add Tab'</span>);

            <span class="comment">% Add '+' addTab button</span>

            obj.fig.Visible = <span class="string">'on'</span>;
<span class="comment">%             h_add = obj.addTab('+');</span>
<span class="comment">%             h_add.ButtonDownFcn = @(x) obj.addTab([],'order',length(obj.tabs)-1);</span>
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> h = addTab(obj,varargin)
</pre><h2>addTab<a name="7"></a></h2><p>Adds a new tab with the given title.</p><pre>ht = h.addTab([title],'Param','ParamValue',...);</pre><p>INPUTS  title - (optional) name of the tab PARAMETERS  order - Specifies the tab order  listName - The plot list title listed at the top   Defaults to 'Plots' OUTPUTS  ht - uitab handle of the added tab</p><p>See also: tfigure, tfigure.tfigure, tfigure.addPlot, tfigure.addTable</p><pre class="codeinput">            <span class="keyword">if</span>(~isempty(varargin) &amp;&amp; (isa(varargin{1},<span class="string">'matlab.ui.container.Menu'</span>) || isa(varargin{1},<span class="string">'matlab.ui.container.Tab'</span>)))
            <span class="comment">% Menu Call or '+' Tab call</span>
            <span class="comment">% When called from the menu there is automatically 2</span>
            <span class="comment">% inputs, the menu and the eventData</span>
                p.Results.titleIn = [<span class="string">'dataset '</span> num2str(length(obj.tabs)+1)];
                p.Results.order = [];
                p.Results.listName = <span class="string">'Plots'</span>;
            <span class="keyword">else</span>
            <span class="comment">% User Call</span>
                p = inputParser;
                addOptional(p,<span class="string">'titleIn'</span>,<span class="keyword">...</span>
                        [<span class="string">'dataset '</span> num2str(length(obj.tabs)+1)],@isstr);
                p.addParameter(<span class="string">'order'</span>,[], <span class="keyword">...</span>
                             @(x) isnumeric(x) &amp;&amp; (x &gt;= 1) &amp;&amp; <span class="keyword">...</span>
                             (x &lt;= (length(obj.tabs)+1)))
                p.addParameter(<span class="string">'listName'</span>,<span class="string">'Plots'</span>, @ischar)
                parse(p,varargin{:});

            <span class="keyword">end</span>

            order = p.Results.order;

            <span class="comment">% Setup tab</span>
            h = uitab(<span class="string">'Parent'</span>, obj.tabGroup,<span class="keyword">...</span>
                      <span class="string">'Title'</span>, p.Results.titleIn,<span class="string">'ButtonDownFcn'</span>,@obj.selectTab);

            <span class="comment">% Setup tab order</span>
            <span class="keyword">if</span>(isempty(order) &amp;&amp; length(obj.tabGroup.Children)&gt;1)
                obj.tabGroup.Children = obj.tabGroup.Children([1:end-2 end end-1]);
            <span class="keyword">elseif</span>(~isempty(order))
                <span class="keyword">if</span>(order &lt;= 1)
                    obj.tabGroup.Children = obj.tabGroup.Children([end 1:end-1]);
                <span class="keyword">elseif</span>((order &gt; 1) &amp;&amp; (order &lt; length(obj.tabGroup.Children)))
                    obj.tabGroup.Children = obj.tabGroup.Children([1:(order-1) end (order):end-1]);
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="comment">% Setup tab context menu</span>
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Add Tab'</span>,<span class="string">'Callback'</span>,@obj.addTab);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Add Plot'</span>,<span class="string">'Callback'</span>,@obj.addPlot);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Add Table'</span>,<span class="string">'Callback'</span>,@obj.addTable);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg,<span class="string">'Separator'</span>,<span class="string">'on'</span>);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Delete'</span>,<span class="string">'Callback'</span>,@obj.deleteDlg,<span class="string">'UserData'</span>,h);

            <span class="comment">% Setup plot list</span>
            figSize = obj.figureSize;
            plotList = uibuttongroup(<span class="string">'parent'</span>,h,<span class="keyword">...</span>
                            <span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                            <span class="string">'Position'</span>,[10 10  150 figSize(4)-45],<span class="keyword">...</span>
                            <span class="string">'tag'</span>,<span class="string">'plotList'</span>,<span class="keyword">...</span>
                            <span class="string">'SelectionChangedFcn'</span>,@obj.selectPlot);
            set(plotList,<span class="string">'Title'</span>,p.Results.listName);

            <span class="comment">% Menu</span>
            plotList.UIContextMenu = uicontextmenu;
            plotList.UIContextMenu.UserData = plotList;
            uimenu(plotList.UIContextMenu,<span class="string">'Label'</span>,<span class="string">'Add Plot'</span>,<span class="string">'Callback'</span>,@obj.addPlot);
            uimenu(plotList.UIContextMenu,<span class="string">'Label'</span>,<span class="string">'Add Table'</span>,<span class="string">'Callback'</span>,@obj.addTable);
            uimenu(plotList.UIContextMenu,<span class="string">'Label'</span>,<span class="string">'Add Label'</span>,<span class="string">'Callback'</span>,@obj.addLabel);
            uimenu(plotList.UIContextMenu,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg,<span class="string">'Separator'</span>,<span class="string">'on'</span>);
            h.UserData = plotList;
            <span class="keyword">if</span>(length(plotList.Children) &lt;= 1)
                plotList.Visible = <span class="string">'off'</span>;
            <span class="keyword">end</span>
            <span class="comment">% Make the new tab current</span>
            obj.tabGroup.SelectedTab = h;
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> ha = addPlot(obj,varargin)
</pre><h2>addPlot<a name="9"></a></h2><p>Adds a plot to the given tab.  When the plot button is selected the plot is selected</p><p>ha = h.addPlot([title],'tab',[h_tab],'plotFcn',[function_handle])</p><p>INPUTS  title - (optional) Uses this string as the plot title displayed   in the plot list PARAMETERS  tab - Selects which tab will contain the table.  The tab can be   specified as a uitab handle or the name of the tab  plotFcn - A function handle to be evaluated when the plot is   selected. OUTPUTS  ha - Handle to the plot axis EXAMPLE  h = tfigure;  ha = h.addPlot('Plot Title');</p><p>see also: tfigure, tfigure.tfigure, tfigure.addTab, tfigure.addTable</p><pre class="codeinput">        <span class="keyword">if</span>(~isempty(varargin) &amp;&amp; ~isa(varargin{1},<span class="string">'matlab.ui.container.Menu'</span>))
            p=inputParser;
            p.addOptional(<span class="string">'title'</span>,<span class="string">'plot'</span>,@ischar)
            p.addParameter(<span class="string">'plotFcn'</span>,[],@(x) (isa(x,<span class="string">'function_handle'</span>) || isempty(x)));
            p.addParameter(<span class="string">'tab'</span>,obj.tabGroup.SelectedTab,@(x) (isa(x,<span class="string">'double'</span>) || isa(x,<span class="string">'matlab.ui.container.Tab'</span>) || ischar(x)));
            p.addParameter(<span class="string">'order'</span>,[],@isnumeric);
            p.parse(varargin{:})
        <span class="keyword">else</span>
            p.Results.tab = obj.tabGroup.SelectedTab;
            p.Results.plotFcn = [];
            p.Results.title = <span class="string">'plot'</span>;
            p.Results.order = [];
        <span class="keyword">end</span>
            <span class="comment">% Select the Tab</span>
            tab = obj.parseTab(p.Results.tab);

            <span class="comment">% Add the new analysis panel to the plot list</span>
            plotList = get(tab,<span class="string">'UserData'</span>); <span class="comment">% The tab's UserData contains a handle to the uibuttongroup for the tab</span>
            h = uicontrol(<span class="string">'parent'</span>,plotList,<span class="keyword">...</span>
                          <span class="string">'Style'</span>, <span class="string">'togglebutton'</span>,<span class="keyword">...</span>
                          <span class="string">'String'</span>, p.Results.title,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                          <span class="string">'tag'</span>,<span class="string">'plot'</span>);

            <span class="comment">% Setup Context Menu</span>
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Delete'</span>,<span class="string">'Callback'</span>,@obj.deleteDlg);
            exportMenu = uimenu(<span class="string">'Parent'</span>,c,<span class="string">'Label'</span>,<span class="string">'Export'</span>);
            uimenu(exportMenu,<span class="string">'Label'</span>,<span class="string">'Copy to Clipboard'</span>,<span class="string">'Callback'</span>,@obj.exportToClipboard);
            uimenu(exportMenu,<span class="string">'Label'</span>,<span class="string">'Copy to Figure'</span>,<span class="string">'Callback'</span>,@obj.exportToFigure);
            <span class="comment">% Setup Panel</span>
            h.UserData.hp = uipanel(<span class="string">'Parent'</span>,tab,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                                    <span class="string">'tag'</span>,<span class="string">'plot'</span>,<span class="string">'BorderType'</span>,<span class="string">'none'</span>);
            h.UserData.hp.UserData.hc = h;

            <span class="comment">% Setup Axes</span>
            ha = axes(h.UserData.hp);<span class="comment">%,...'Units','pixels',...</span>
<span class="comment">%                              'ActivePositionProperty','OuterPosition');</span>
            ha.Visible = <span class="string">'on'</span>;

            <span class="comment">% Setup order</span>
            plotList.Children = tfigure.childReorder(plotList.Children,p.Results.order);

            <span class="keyword">if</span>(~isempty(p.Results.plotFcn))
                h.UserData.fh = p.Results.plotFcn;
                p.Results.plotFcn();
            <span class="keyword">else</span>
                h.UserData.fh = [];
            <span class="keyword">end</span>
            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> varargout = addTable(obj,varargin)
</pre><h2>addTable<a name="11"></a></h2><p>Adds a table to the given tab.</p><p>ht = h.addTable([title],'Param','ParamValue',...)</p><p>INPUTS  title - (optional) The table title to displayed on the selection   button PARAMETERS  tab - Selects which tab will contain the table.  The tab can be   specified as a uitab handle or the name of the tab  order - Position in the plot list  style - Selects between the default MATLAB table and a Java   table. uitable: 'uitable or 'ui'  Java Table: 'Java',   'JavaTable' OUTPUTS  ht - handle to the table</p><p>See also: tfigure.addPlot tfigure.addLabel tfigure.addCtrl</p><pre class="codeinput">        <span class="keyword">if</span>(~isempty(varargin) &amp;&amp; ~isa(varargin{1},<span class="string">'matlab.ui.container.Menu'</span>))
            p=inputParser;
            p.addOptional(<span class="string">'title'</span>,<span class="string">'table'</span>,@ischar)
            p.addParameter(<span class="string">'tab'</span>,obj.tabGroup.SelectedTab,@(x) (isa(x,<span class="string">'double'</span>) || isa(x,<span class="string">'matlab.ui.container.Tab'</span>) || ischar(x)))
            p.addParameter(<span class="string">'order'</span>,[],@isnumeric);
            p.addParameter(<span class="string">'style'</span>,<span class="string">'uitable'</span>,<span class="keyword">...</span>
                @(x) any(validatestring(x,{<span class="string">'uitable'</span>,<span class="string">'ui'</span>,<span class="string">'JavaTable'</span>,<span class="string">'Java'</span>})))
            p.parse(varargin{:})
        <span class="keyword">else</span>
            p.Results.tab = obj.tabGroup.SelectedTab;
            p.Results.title = <span class="string">'table'</span>;
            p.Results.order = [];
            p.Results.style = <span class="string">'uitable'</span>;
        <span class="keyword">end</span>
            <span class="comment">% Select the Tab</span>
            tab = obj.parseTab(p.Results.tab);

            <span class="comment">% Add the new plot to the plot list</span>
            plotList = get(tab,<span class="string">'UserData'</span>); <span class="comment">% The tab's UserData contains a handle to the uibuttongroup for the tab</span>
            h = uicontrol(<span class="string">'parent'</span>,plotList,<span class="keyword">...</span>
                            <span class="string">'Style'</span>, <span class="string">'togglebutton'</span>,<span class="keyword">...</span>
                            <span class="string">'String'</span>, p.Results.title,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                            <span class="string">'tag'</span>,<span class="string">'table'</span>);
<span class="comment">%             h.UserData = p.Results.fun_handle;</span>

            <span class="comment">% Setup Context Menu</span>
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Delete'</span>,<span class="string">'Callback'</span>,@obj.deleteDlg);

            <span class="comment">% Setup Panel</span>
            h.UserData.hp = uipanel(<span class="string">'Parent'</span>,tab,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                                    <span class="string">'tag'</span>,<span class="string">'plot'</span>,<span class="string">'BorderType'</span>,<span class="string">'none'</span>);
            h.UserData.hp.UserData.hc = h;
            h.UserData.fh = [];

            <span class="comment">% Setup Table</span>
            <span class="keyword">if</span>(strcmpi(p.Results.style,<span class="string">'uitable'</span>) || strcmpi(p.Results.style,<span class="string">'ui'</span>))
                ht = uitable(<span class="string">'Parent'</span>,h.UserData.hp,<span class="string">'Units'</span>,<span class="string">'normalized'</span>,<span class="string">'Position'</span>,[0 0 1 1]);<span class="comment">%,'Units','pixels');</span>
            <span class="keyword">elseif</span>(strcmpi(p.Results.style,<span class="string">'JavaTable'</span>) || strcmpi(p.Results.style,<span class="string">'java'</span>))
                <span class="keyword">if</span>(~(exist(<span class="string">'exportToPPTX'</span>,<span class="string">'file'</span>)))
                    error(<span class="string">'tfigure:NeedExportToPPTX'</span>,<span class="keyword">...</span>
                         [<span class="string">'createTable must be added to the path. '</span>,<span class="keyword">...</span>
                        <span class="string">'It can be downloaded from the MATLAB file exchange, search for "Java-based data table"'</span>]);
                <span class="keyword">end</span>
                ht = uiextras.jTable.Table(<span class="string">'Parent'</span>,h.UserData.hp);
            <span class="keyword">end</span>
            <span class="comment">%             h.UserData.fa.Visible = 'on';</span>
            h.UserData.hp.UserData.hc = ht;

            <span class="comment">% Setup order</span>
            plotList.Children = tfigure.childReorder(plotList.Children,p.Results.order);

            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);

            <span class="comment">% Setup outputs</span>
            <span class="keyword">if</span>(nargout == 0)
                varargout = {};
            <span class="keyword">elseif</span>(nargout == 1)
                varargout = {ht};
            <span class="keyword">elseif</span>(nargout == 2)
                varargout = {ht h};
            <span class="keyword">else</span>
                error(<span class="string">'tfigure:addTable:nargoutWrong'</span>,<span class="string">'The number of outputs must be 0-2'</span>);
            <span class="keyword">end</span>
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> h = addLabel(obj,varargin)
</pre><h2>addLabel Adds a label to the plot list<a name="13"></a></h2><pre>hl = h.addLabel(title,[tab],...)</pre><p>INPUTS  title - text to display PARAMETERS  title - text to display  order - Position in the plot list  tab - Selects which tab will contain the table.  The tab can be   specified as a uitab handle or the name of the tab OUTPUTS  hl - label handle</p><p>see also: tfigure, tfigure.tfigure, tfigure.addTab, tfigure.addTable</p><pre class="codeinput">            <span class="keyword">if</span>(~isempty(varargin) &amp;&amp; ~isa(varargin{1},<span class="string">'matlab.ui.container.Menu'</span>))
                p=inputParser;
                p.addRequired(<span class="string">'title'</span>,@ischar);
                p.addParameter(<span class="string">'tab'</span>,obj.tabGroup.SelectedTab,@(x) (isa(x,<span class="string">'double'</span>) || isa(x,<span class="string">'matlab.ui.container.Tab'</span>) || ischar(x)))
                p.addParameter(<span class="string">'order'</span>,[],@isnumeric);
                p.parse(varargin{:})
            <span class="keyword">else</span>
                p.Results.title = inputdlg(<span class="string">'Label:'</span>,<span class="string">'Label'</span>,1,{<span class="string">''</span>});
                p.Results.tab = obj.tabGroup.SelectedTab;
                p.Results.order = [];
            <span class="keyword">end</span>

            <span class="comment">% Select the Tab</span>
            tab = obj.parseTab(p.Results.tab);

            <span class="comment">% Add the new label to the plot list</span>
            plotList = get(tab,<span class="string">'UserData'</span>); <span class="comment">% The tab's UserData contains a handle to the uibuttongroup for the tab</span>
            h = uicontrol(<span class="string">'parent'</span>,plotList,<span class="keyword">...</span>
                          <span class="string">'Style'</span>, <span class="string">'text'</span>,<span class="keyword">...</span>
                          <span class="string">'String'</span>, p.Results.title,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                          <span class="string">'tag'</span>,<span class="string">'label'</span>);

            <span class="comment">% Setup Context Menu</span>
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Delete'</span>,<span class="string">'Callback'</span>,@obj.deleteDlg);

            <span class="comment">% Setup order</span>
            plotList.Children = tfigure.childReorder(plotList.Children,p.Results.order);

            obj.selectPlot(plotList,[]);
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> h = addCtrl(obj,varargin)
</pre><h2>addCtrl<a name="15"></a></h2><p>Adds a control panel to a tab  Requires a fun_handle which points to the control panel function  which defines its contents</p><pre>hp = h.addCtrl([title],[fun_handle(h_panel)],'Param','value')
INPUTS
title - (optional) text of the control's plot list button
fun_handle - (optional) A function that defines the control panel.  It has
 a single input that is a handle to the panel that will contain
 the control panel.
PARAMETERS
order - Position in the plot list
tab - Selects which tab will contain the table.  The tab can be
 specified as a uitab handle or the name of the tab
OUTPUTS
 hp - handle for the control panel's plot list button</pre><p>See also: tfigure, tfigure.tfigure</p><pre class="codeinput">            p=inputParser;
            p.addOptional(<span class="string">'title'</span>,<span class="string">'Options'</span>,@ischar);
            p.addOptional(<span class="string">'fun_handle'</span>,[],@(x) isa(x,<span class="string">'function_handle'</span>));
            p.addParameter(<span class="string">'tab'</span>,obj.tabGroup.SelectedTab,@(x) (isa(x,<span class="string">'double'</span>) || isa(x,<span class="string">'matlab.ui.container.Tab'</span>) || ischar(x)));
            p.addParameter(<span class="string">'order'</span>,[],@isnumeric);
            p.parse(varargin{:});

            <span class="comment">% Select the Tab</span>
            tab = obj.parseTab(p.Results.tab);

            <span class="comment">% Add the new control panel to the plot list</span>
            figSize = obj.figureSize;
            plotList = get(tab,<span class="string">'UserData'</span>); <span class="comment">% The tab's UserData contains a handle to the uibuttongroup for the tab</span>
            h = uicontrol(<span class="string">'parent'</span>,plotList,<span class="keyword">...</span>
                          <span class="string">'Style'</span>, <span class="string">'togglebutton'</span>,<span class="keyword">...</span>
                          <span class="string">'String'</span>, p.Results.title,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                          <span class="string">'tag'</span>,<span class="string">'ctrl'</span>);
            <span class="comment">% Setup Control Panel</span>
            h_panel = uipanel(<span class="string">'Parent'</span>,tab,<span class="keyword">...</span>
                              <span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="keyword">...</span>
                              <span class="string">'Position'</span>,[30 30  figSize(3)-30 figSize(4)-30],<span class="keyword">...</span>
                              <span class="string">'tag'</span>,<span class="string">'ctrl'</span>,<span class="keyword">...</span>
                              <span class="string">'Title'</span>,p.Results.title);
            h.UserData.hp = h_panel;

            <span class="comment">% Setup Context Menu</span>
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Rename'</span>,<span class="string">'Callback'</span>,@obj.renameDlg);
            uimenu(c,<span class="string">'Label'</span>,<span class="string">'Delete'</span>,<span class="string">'Callback'</span>,@obj.deleteDlg);
<span class="comment">%             h.UserData.fa = axes('Parent',tab,'Units','pixels',...</span>
<span class="comment">% ...%                              'position',axesSize,...</span>
<span class="comment">%                              'ActivePositionProperty','OuterPosition');</span>
<span class="comment">%             h.UserData.fa.Visible = 'on';</span>

            <span class="comment">% Setup order</span>
            plotList.Children = tfigure.childReorder(plotList.Children,p.Results.order);

            <span class="keyword">if</span>(~isempty(p.Results.fun_handle))
                h.UserData.fh = p.Results.fun_handle;
                p.Results.fun_handle(h_panel);
            <span class="keyword">end</span>
            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="comment">%function export(obj,varargin)</span>
        <span class="comment">% export Exports an analysis panel, a tab, or an entire tfigure using</span>
        <span class="comment">% the specified format</span>
        <span class="comment">%</span>
        <span class="comment">% Not currently implemented</span>
        <span class="comment">%end</span>
        <span class="keyword">function</span> exportToClipboard(obj,varargin)
</pre><h2>exportToClipboard<a name="17"></a></h2><p>Exports a panel to the clipboard as if it it were in its own figure</p><p>obj.exportToClipboard([panel]</p><p>INPUTS  panel - (optional) a panel handle to be exported   Uses the current panel (obj.gcp) by default</p><p>See also: tfigure, tfigure.tfigure</p><pre class="codeinput">            <span class="keyword">if</span>(nargin == 2)
                p = inputParser;
                p.addOptional(<span class="string">'panel'</span>,obj.gcp,@(x) strcmp(x.Type,<span class="string">'uipanel'</span>))
                p.parse(varargin{:});
            <span class="keyword">elseif</span>(nargin == 3)
                <span class="keyword">if</span>(~isempty(varargin{1}.Parent.UserData) &amp;&amp; strcmp(varargin{1}.Parent.UserData.Type,<span class="string">'uicontrol'</span>))
                    p.Results.panel = varargin{1}.Parent.UserData.UserData.hp;
                <span class="keyword">else</span>
                    p.Results.panel = obj.gcp;
                <span class="keyword">end</span>
            <span class="keyword">else</span>
                p.Results.panel = obj.gcp;
            <span class="keyword">end</span>

            <span class="comment">% Copy the panel to a seperate figure and copy tp clipboard</span>
            hf = figure(<span class="string">'Visible'</span>,<span class="string">'off'</span>,<span class="string">'Color'</span>,<span class="string">'w'</span>);
            hp = copy(p.Results.panel);
            hp.Parent = hf;
            hp.BackgroundColor = <span class="string">'w'</span>;
            hp.Units = <span class="string">'normalized'</span>;
            hp.Position = [0 0 1 1];
            hp.Visible = <span class="string">'on'</span>;
            print(hf,<span class="string">'-clipboard'</span>,<span class="string">'-dbitmap'</span>)
            close(hf);
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> varargout = exportToFigure(obj,varargin)
        <span class="comment">% exportToFigure Copies a panel to a new figure</span>
        <span class="comment">%</span>
        <span class="comment">% USAGE:</span>
        <span class="comment">%  hf = h.exportToFigure</span>
        <span class="comment">%  hf = exportToFigure(h)</span>
        <span class="comment">%   Copies current panel (h.gcp) to a new figure with handle hf</span>
        <span class="comment">%  hf = h.exportToFigure(panel)</span>
        <span class="comment">%   Copies panel (panel) to a new figure with handle hf</span>
        <span class="comment">%</span>
        <span class="comment">% INPUTS</span>
        <span class="comment">%  panel - (optional) a panel handle to be exported</span>
        <span class="comment">%   Uses the current panel (obj.gcp) by default</span>
        <span class="comment">% OUTPUTS</span>
        <span class="comment">%  hf - a handle to the newly created figure</span>
        <span class="comment">%</span>
        <span class="comment">% See also: tfigure, tfigure.tfigure</span>
            <span class="keyword">if</span>(nargin == 1)
                panel = obj.gcp;
            <span class="keyword">elseif</span>(isa(varargin{1},<span class="string">'matlab.ui.container.Panel'</span>))
                panel = varargin{1};
            <span class="keyword">elseif</span>(nargin == 3 &amp;&amp; isa(varargin{1},<span class="string">'matlab.ui.container.Menu'</span>))
            <span class="comment">% Callback</span>
                panel = varargin{1}.Parent.Parent.UserData.UserData.hp;
            <span class="keyword">else</span>
                panel = obj.gcp;
            <span class="keyword">end</span>

            <span class="keyword">if</span>(nargin&gt;2 &amp;&amp; ~isa(varargin{1},<span class="string">'matlab.ui.container.Menu'</span>))
                h = figure(varargin{2:end});
            <span class="keyword">else</span>
                h = figure;
            <span class="keyword">end</span>
            hp = copy(panel);
            hp.Units = <span class="string">'normalized'</span>;
            hp.Position = [0 0 1 1];
            hp.Parent = h;
            hp.Visible = <span class="string">'on'</span>;
            <span class="keyword">if</span>(nargout == 1)
                varargout{1} = h;
            <span class="keyword">elseif</span>(nargout == 2)
                varargout = {h hp};
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">function</span> savePPT(obj,varargin)
</pre><h2>savePPT<a name="19"></a></h2><p>Saves all the plots in tfigure to a powerpoint presentation.</p><p>h.savePPT(...)  Brings up a file selection dialog h.savePPT(fileName,...)</p><p>FILENAME  fileName - file name of the file to save the plots PARAMETERS:  title - Title of the presentation  subject - subject of presentation, included in file meta data  comments - comments on the presentation  author - Author's name</p><p>See also: tfigure, tfigure.tfigure</p><pre class="codeinput">            <span class="keyword">if</span>(~(exist(<span class="string">'exportToPPTX'</span>,<span class="string">'file'</span>)))
               error(<span class="string">'tfigure:NeedExportToPPTX'</span>,<span class="keyword">...</span>
                     [<span class="string">'exportToPPTX must be added to the path. '</span>,<span class="keyword">...</span>
                     <span class="string">'It can be downloaded from the MATLAB file exchange'</span>]);
            <span class="keyword">end</span>
            <span class="keyword">if</span>(~isempty(obj.fig.Name))
                figTitle = obj.fig.Name;
            <span class="keyword">else</span>
                figTitle = [<span class="string">'Figure '</span> num2str(obj.fig.Number) <span class="string">' Data'</span>];
            <span class="keyword">end</span>
            p = inputParser;
            p.addOptional(<span class="string">'fileName'</span>,<span class="string">''</span>,@ischar);
            p.addParameter(<span class="string">'title'</span>,figTitle);
            p.addParameter(<span class="string">'author'</span>,<span class="string">''</span>);
            p.addParameter(<span class="string">'subject'</span>,<span class="string">''</span>);
            p.addParameter(<span class="string">'comments'</span>,<span class="string">''</span>);
            p.parse(varargin{:});
            <span class="keyword">if</span>(isempty(p.Results.fileName))
                [fileName,pathname] = uiputfile(<span class="string">'.pptx'</span>,<span class="string">'Export PPTX: select a file name'</span>);
                <span class="keyword">if</span>(fileName ~= 0)
                    fileName = fullfile(pathname,fileName);
                <span class="keyword">else</span>
                    <span class="keyword">return</span>
                <span class="keyword">end</span>
            <span class="keyword">else</span>
                fileName = p.Results.fileName;
            <span class="keyword">end</span>
            isOpen  = exportToPPTX();
            <span class="keyword">if</span> ~isempty(isOpen),
                <span class="comment">% If PowerPoint already started, then close first and then open a new one</span>
                exportToPPTX(<span class="string">'close'</span>);
            <span class="keyword">end</span>
            exportToPPTX(<span class="string">'new'</span>,<span class="keyword">...</span><span class="comment"> %'Dimensions',[12 6], ...</span>
                         <span class="string">'Title'</span>,p.Results.title, <span class="keyword">...</span>
                         <span class="string">'Author'</span>,p.Results.author, <span class="keyword">...</span>
                         <span class="string">'Subject'</span>,p.Results.subject, <span class="keyword">...</span>
                         <span class="string">'Comments'</span>,p.Results.comments);
            exportToPPTX(<span class="string">'addslide'</span>);
            exportToPPTX(<span class="string">'addtext'</span>,p.Results.title,<span class="keyword">...</span>
                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
                         <span class="string">'VerticalAlignment'</span>,<span class="string">'middle'</span>,<span class="string">'FontSize'</span>,48);
            <span class="keyword">for</span> tabNum = 1:length(obj.tabs)
                ht = obj.tabs(tabNum);
<span class="comment">%                 hp = findobj(ht.Children,'tag','plot');</span>
                exportToPPTX(<span class="string">'addslide'</span>);
                exportToPPTX(<span class="string">'addtext'</span>,ht.Title,<span class="keyword">...</span>
                             <span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>,<span class="keyword">...</span>
                             <span class="string">'VerticalAlignment'</span>,<span class="string">'middle'</span>,<span class="string">'FontSize'</span>,48);
                panels = [ht.UserData.Children.UserData];
                panels = [panels.hp];
                <span class="keyword">for</span> panelNum = 1:length(panels)
                    [h hp] = obj.exportToFigure(panels(panelNum),<span class="string">'Visible'</span>,<span class="string">'off'</span>);
                    hp.BackgroundColor = <span class="string">'w'</span>;
                    exportToPPTX(<span class="string">'addslide'</span>);
                    exportToPPTX(<span class="string">'addpicture'</span>,h,<span class="string">'Scaled'</span>,<span class="string">'maxfixed'</span>);
                    close(h);
                <span class="keyword">end</span>
            <span class="keyword">end</span>
            exportToPPTX(<span class="string">'save'</span>,fileName);
            exportToPPTX(<span class="string">'close'</span>);
</pre><pre class="codeinput">        <span class="keyword">end</span>
        <span class="keyword">function</span> out = get.figureSize(obj)
            out = get(obj.fig,<span class="string">'position'</span>);
        <span class="keyword">end</span>
        <span class="keyword">function</span> set.figureSize(obj,val)
            set(obj.fig,<span class="string">'position'</span>,val);
        <span class="keyword">end</span>
        <span class="keyword">function</span> h = get.gct(obj)
        <span class="comment">% gct Get Current Tab</span>
        <span class="comment">%  Returns the handle to the current tab</span>
        h = obj.tabGroup.SelectedTab;
        <span class="keyword">end</span>
        <span class="keyword">function</span> h = get.gcp(obj)
        <span class="comment">% gcp Get Current Panel</span>
        <span class="comment">%  Returns the handle to the current tab</span>
            <span class="keyword">if</span>(~isempty(obj.gct.UserData.SelectedObject))
                h = obj.gct.UserData.SelectedObject.UserData.hp;
            <span class="keyword">else</span>
                h = [];
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">function</span> t = get.tabs(obj)
            t = obj.tabGroup.Children(1:end-1);
        <span class="keyword">end</span>
<span class="comment">%         function set.tabs(obj,in)</span>
<span class="comment">%             obj.tabs = [in obj.tabs(end)]</span>
<span class="comment">%         end</span>
    <span class="keyword">end</span>
    methods (Access = private)
        <span class="keyword">function</span> figResize(obj,src,~) <span class="comment">% callbackdata is unused 3rd arg.</span>
        <span class="comment">% figResize Resizes the gui elements in each tab whenever the</span>
        <span class="comment">%  figure is resized.</span>
            figSize = obj.figureSize;

            <span class="comment">% Set minimum figure size</span>
<span class="comment">%             if(figSize(3)&lt;560)</span>
<span class="comment">%                 figSize(3) = 560;</span>
<span class="comment">%             end</span>
<span class="comment">%             if(figSize(4)&lt;420)</span>
<span class="comment">%                 figSize(4) = 420;</span>
<span class="comment">%             end</span>
<span class="comment">%             obj.figureSize = figSize;</span>

            <span class="comment">% Find selected tab and plot</span>
<span class="comment">%             currTab = obj.tabGroup.SelectedTab;</span>
            <span class="keyword">if</span>(~isempty(obj.gct.UserData.SelectedObject))
                numPlots = length(obj.gct.UserData.Children);
            <span class="keyword">else</span>
                numPlots = 0;
            <span class="keyword">end</span>

            <span class="comment">% Plot list adjustment</span>
            <span class="keyword">if</span>(numPlots==1)
                plotListAdj = [-160 0 150 0];
            <span class="keyword">else</span>
                plotListAdj = [0 0 0 0];
            <span class="keyword">end</span>

            <span class="comment">%Resize Current "Axes"</span>
            <span class="keyword">if</span>(strcmp(get(obj.gcp,<span class="string">'tag'</span>),<span class="string">'ctrl'</span>)) <span class="comment">% Resize ctrl panels</span>
                set(obj.gcp,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'Position'</span>,[170 10  figSize(3)-185 figSize(4)-45]<span class="keyword">...</span>
                                                   <span class="keyword">...</span><span class="comment">%- [0 0 ceil(leg_pos(3)) 0]... % Legend Adjustment</span>
                                                   + plotListAdj); <span class="comment">% Plot list adjustment</span>
            <span class="keyword">else</span> <span class="comment">% Resize Axes</span>
            set(obj.gcp,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'Position'</span>,[170 10  figSize(3)-185 figSize(4)-45]<span class="keyword">...</span>
                                                   <span class="keyword">...</span><span class="comment">%- [0 0 ceil(leg_pos(3)) 0]... % Legend Adjustment</span>
                                                   + plotListAdj); <span class="comment">% Plot list adjustment</span>
            <span class="keyword">end</span>
            <span class="comment">% Resize the plot list</span>
            plots = obj.gct.UserData.Children;
            <span class="keyword">for</span> n = 1:length(plots)
                set(plots(n),<span class="string">'Position'</span>,[10 figSize(4)-85-30*(n-1) 120 20]);
            <span class="keyword">end</span>

            <span class="comment">% Resize each list of plots</span>
            plotLists = findobj(src,<span class="string">'tag'</span>,<span class="string">'plotList'</span>,<span class="string">'-and'</span>,<span class="keyword">...</span>
                                <span class="string">'Type'</span>,<span class="string">'uibuttongroup'</span>);
            set(plotLists,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'Position'</span>,[10 10  150 figSize(4)-45]);
        <span class="keyword">end</span>
        <span class="keyword">function</span> selectPlot(obj,src,~) <span class="comment">% ~ is callbackdata</span>
        <span class="comment">% selectPlot Runs whenever a plot is selected from the plot list</span>
            <span class="keyword">if</span>(length(src.Children) &gt; 1)
                h_panels = [src.Children.UserData];
                h_panels = [h_panels.hp];
                set(h_panels,<span class="string">'visible'</span>,<span class="string">'off'</span>)

                src.SelectedObject.UserData.hp.Visible = <span class="string">'on'</span>;
                src.Visible = <span class="string">'on'</span>;
                <span class="keyword">if</span>(~isempty(findobj(src.SelectedObject.UserData.hp.Children,<span class="string">'Type'</span>,<span class="string">'axes'</span>)))
                    axes(findobj(src.SelectedObject.UserData.hp.Children,<span class="string">'Type'</span>,<span class="string">'axes'</span>));
                <span class="keyword">end</span>
            <span class="keyword">end</span>
            obj.figResize(obj.fig);
        <span class="keyword">end</span>
        <span class="keyword">function</span> selectTab(obj,b,c)
            obj.figResize(obj.fig);
            <span class="keyword">if</span>(~isempty(obj.gcp) &amp;&amp; <span class="keyword">...</span>
               ~isempty(findobj(obj.gcp.Children,<span class="string">'Type'</span>,<span class="string">'axes'</span>)))
                axes(findobj(obj.gcp.Children,<span class="string">'Type'</span>,<span class="string">'axes'</span>));
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">function</span> tab_out = parseTab(obj,tab)
        <span class="comment">% parseTab - parses a tab input, creating a new tab if the tab</span>
        <span class="comment">%  input is a tab name that doesn't exist.  Can accept a handle or</span>
        <span class="comment">%  a string input of the tab name.</span>
            <span class="keyword">if</span>(ischar(tab))
                tab_obj = findobj(obj.tabs,<span class="string">'Type'</span>,<span class="string">'uitab'</span>,<span class="string">'Title'</span>,tab);
                <span class="keyword">if</span>(isempty(tab_obj))
                    tab_out = obj.addTab(tab);
                <span class="keyword">else</span>
                    tab_out = tab_obj;
                <span class="keyword">end</span>
            <span class="keyword">else</span>
                tab_out = tab;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">function</span> exportMenu(obj,menu,~)
        <span class="comment">% Export menu callback</span>
        <span class="comment">%  Executes the requested depending on the selected export option</span>
            <span class="keyword">if</span>(strcmp(menu.Label,<span class="string">'Export PPT'</span>))
                obj.savePPT();
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">function</span> renameDlg(~,menu,~) <span class="comment">% ~ is obj, ActionData</span>
        <span class="comment">% renameDlg Diaglog box for renaming plots and tabs from a context</span>
        <span class="comment">%  menu</span>
            type = get(menu.Parent.UserData,<span class="string">'Type'</span>);
            <span class="keyword">if</span>(strcmpi(type,<span class="string">'uicontrol'</span>))
                prevName = {menu.Parent.UserData.String};
                <span class="comment">% Get new name from the user</span>
                newName = inputdlg(<span class="string">'New Name:'</span>,<span class="string">'Rename'</span>,1,prevName);
                <span class="keyword">if</span>(~isempty(newName))
                    menu.Parent.UserData.String = newName{1};
                <span class="keyword">end</span>
            <span class="keyword">elseif</span>(any(strcmpi(type, {<span class="string">'uitab'</span>,<span class="string">'uibuttongroup'</span>})))
                prevName = {menu.Parent.UserData.Title};
                <span class="comment">% Get new name from the user</span>
                newName = inputdlg(<span class="string">'New Name:'</span>,<span class="string">'Rename'</span>,1,prevName);
                <span class="keyword">if</span>(~isempty(newName))
                    menu.Parent.UserData.Title = newName{1};
                <span class="keyword">end</span>
            <span class="keyword">else</span>
                error(<span class="string">'tfigure:renameDlg:unknownSelectionType'</span>,<span class="keyword">...</span>
                      <span class="string">'unknown selection type, need to add ui type to be renamed to the callback function'</span>);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">function</span> deleteDlg(obj,menu,~)
        <span class="comment">% deleteDlg function for deleting tabs and plots.  Double checks</span>
        <span class="comment">% with the user if a plot already exists.</span>
        <span class="comment">%  menu</span>
<span class="comment">%         h = warndlg(['The tab "'</span>
<span class="comment">%             h_dlg = warndlg({'The following tab will be deleted:'; menu.Parent.UserData.Title}, 'Delete Tab Warning','modal');</span>
<span class="comment">%             choice = questdlg({'The following tab will be deleted:'; menu.Parent.UserData.Title},'Delete Warning','OK','cancel','cancel')</span>
<span class="comment">%             switch choice</span>
<span class="comment">%                 case 'OK'</span>
<span class="comment">%             if(find(menu.UserData.Parent.Children == menu.UserData)  == length(menu.UserData.Parent.Children)-1)</span>
<span class="comment">%                 selectPrevTabFcn = menu.UserData.Parent.Children(end-2).ButtonDownFcn;</span>
<span class="comment">%             else</span>
<span class="comment">%                 selectPrevTabFcn = @(x)(1);</span>
<span class="comment">%             end</span>
            delete(menu.Parent.UserData);
            <span class="keyword">if</span>(length(obj.gct.Parent.Children)&gt;1 &amp;&amp; find(obj.gct == obj.gct.Parent.Children) == length(obj.gct.Parent.Children))
                obj.gct.Parent.SelectedTab = obj.gct.Parent.Children(end-1);
            <span class="keyword">end</span>
<span class="comment">%             selectPrevTabFcn();</span>
<span class="comment">%             end</span>

<span class="comment">%             x =0;</span>
<span class="comment">%             if(isvalid(h_dlg))</span>
<span class="comment">%                 delete(menu.Parent.UserData);</span>
<span class="comment">%             end</span>
<span class="comment">%             type = get(menu.Parent.UserData,'Type');</span>
<span class="comment">%             if(strcmpi(type,'uicontrol'))</span>
<span class="comment">%</span>
<span class="comment">%             else</span>
<span class="comment">%</span>
<span class="comment">%             end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    methods (Access = private, Static = true)
        <span class="keyword">function</span> children = childReorder(children,order)
        <span class="comment">% childReorder reorders the children of tabs or plot lists</span>
        <span class="comment">%</span>
        <span class="comment">% INPUTS</span>
        <span class="comment">%  children -</span>
        <span class="comment">%  Order - sets the an integer between 1 and length(children)+1 that</span>
        <span class="comment">%  specifies its index.  If order is empty, the first child is</span>
        <span class="comment">%  moved to the last child</span>
        <span class="comment">%</span>
        <span class="comment">%</span>
            <span class="keyword">if</span>(isempty(order) || (order &gt;= length(children)+1))
                children = children([2:end 1]);
            <span class="keyword">elseif</span>((order &gt; 1) &amp;&amp; (order &lt; length(children)))
                children = children([2:order 1 (order+1):end]);
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016a</a><br></p></div><!--
##### SOURCE BEGIN #####
classdef tfigure < hgsetget
    %% TFIGURE 
    % A figure for holding tabbed groups of plots.
    % Creates a tabbed plot figure.  This allows the user to setup tabs
    % to group plots.  Each tab contains a list of plots that can be
    % selected using buttons on the left of the figure.
    %    
    % Example
    %  h = tfigure;
    %  h = tfigure('Tab_title');
    %
    % tfigure Properties:
    %  fig - Handle to the figure that displays tfigure.
    %  tabs - Handles to each of the tfigure's tabs
    %  figureSize - Current size of the figure containing tfigure
    %  gct - get current tab
    %  gcp - get current panel
    %
    % tfigure Methods:
    %  tfigure - Constructs a new tabbed figure
    %  addTab - Adds a new tab
    %  addPlot - Adds a new plot to the given tab
    %  addTable - Adds a table to the plot list
    %  addLabel - Adds a label to the plot list
    %  addCtrl - Adds a control panel to the plot list
    %  savePPT - Saves all plots to a Power Point presentation.
    %
    % Examples:
    %  tFigExample - tfigure example
    %
    % SETUP:
    %  Files that can be downloaded from the MATLAB file exchange
    %  exportToPPTX - Required to export to a pptx presentation
    %   <https://www.mathworks.com/matlabcentral/fileexchange/40277-exporttopptx>
    %
    % See issues in Github:
    % <https://github.com/curtisma/MATLAB_tfigure/issues>
    %    
    % Author: Curtis Mayberry
    % Curtisma3@gmail.com
    % Curtisma.org
    %
    % See Also: tFigExample, tfigure.tfigure
    
    %% *Properties*
    % Class properties
    properties
        fig % Handle to the figure that displays tfigure.
%         tabs % Handles to each of the tfigure's tabs
        menu % Tfigure menu
    end
    properties (Dependent)
        tabs % Handles to each of the tfigure's tabs
        figureSize % Current size of the figure containing tfigure
        gct % Get Current Tab
        gcp % Get Current Panel
    end
    properties (Access = private)
        tabGroup
    end
    %% *Methods*
    % Class methods
    methods
        function obj = tfigure(varargin)
        %% TFIGURE([title_tab1]) Creates a new tabbed figure.
        %  Additional tabs can be added to the figure using the addTab
        %  function.  Plots can be added to each tab by using the addPlot
        %  function.
        %
        %  h = tfigure;
        %   Creates a tfigure object
        %  h2 = tfigure('Data Tab #1');
        %   Creates a tfigure object with "Data Tab #1" as the tab title.
        %
        % INPUTS
        %  title_tab1 - (optional) The title of the first tab to be added.
        % OUTPUTS
        %  h - a tfigure object
        % 
        % see also: tFigExample
        %
        	obj.fig = figure('Visible','off',...
                             'SizeChangedFcn',@obj.figResize,...
                             'Interruptible','off'); 
            obj.tabGroup = uitabgroup('Parent', obj.fig);
            if(nargin>0)
                obj.addTab(varargin{:});
            else
                obj.addTab;
            end
%             obj.menu = uimenu(obj.fig,'Label','Tfigure');
            obj.menu = uimenu(obj.fig,'Label','Export');
            uimenu(obj.menu,'Label','Export PPT','Callback',@obj.exportMenu)
            uimenu(obj.menu,'Label','Copy Panel to Clipboard','Callback',@obj.exportToClipboard);
            
            uitab('Parent', obj.tabGroup,'Title','+',...
                  'ButtonDownFcn',@obj.addTab,'TooltipString','Add Tab');
            
            % Add '+' addTab button
            
            obj.fig.Visible = 'on';
%             h_add = obj.addTab('+');
%             h_add.ButtonDownFcn = @(x) obj.addTab([],'order',length(obj.tabs)-1);
        end
        function h = addTab(obj,varargin)
        %% addTab
        % Adds a new tab with the given title.
        %
        %  ht = h.addTab([title],'Param','ParamValue',...);
        %
        % INPUTS
        %  title - (optional) name of the tab
        % PARAMETERS
        %  order - Specifies the tab order
        %  listName - The plot list title listed at the top
        %   Defaults to 'Plots'
        % OUTPUTS
        %  ht - uitab handle of the added tab
        %
        % See also: tfigure, tfigure.tfigure, tfigure.addPlot,
        % tfigure.addTable
            if(~isempty(varargin) && (isa(varargin{1},'matlab.ui.container.Menu') || isa(varargin{1},'matlab.ui.container.Tab')))
            % Menu Call or '+' Tab call
            % When called from the menu there is automatically 2
            % inputs, the menu and the eventData
                p.Results.titleIn = ['dataset ' num2str(length(obj.tabs)+1)];
                p.Results.order = [];
                p.Results.listName = 'Plots';
            else
            % User Call
                p = inputParser;
                addOptional(p,'titleIn',...
                        ['dataset ' num2str(length(obj.tabs)+1)],@isstr);
                p.addParameter('order',[], ...
                             @(x) isnumeric(x) && (x >= 1) && ... 
                             (x <= (length(obj.tabs)+1)))
                p.addParameter('listName','Plots', @ischar)
                parse(p,varargin{:});
                
            end
            
            order = p.Results.order;
            
            % Setup tab
            h = uitab('Parent', obj.tabGroup,...
                      'Title', p.Results.titleIn,'ButtonDownFcn',@obj.selectTab);
            
            % Setup tab order
            if(isempty(order) && length(obj.tabGroup.Children)>1)
                obj.tabGroup.Children = obj.tabGroup.Children([1:end-2 end end-1]);
            elseif(~isempty(order))
                if(order <= 1)
                    obj.tabGroup.Children = obj.tabGroup.Children([end 1:end-1]);
                elseif((order > 1) && (order < length(obj.tabGroup.Children)))
                    obj.tabGroup.Children = obj.tabGroup.Children([1:(order-1) end (order):end-1]);
                end
            end
            
            % Setup tab context menu
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,'Label','Add Tab','Callback',@obj.addTab);
            uimenu(c,'Label','Add Plot','Callback',@obj.addPlot);
            uimenu(c,'Label','Add Table','Callback',@obj.addTable);
            uimenu(c,'Label','Rename','Callback',@obj.renameDlg,'Separator','on');
            uimenu(c,'Label','Delete','Callback',@obj.deleteDlg,'UserData',h);
            
            % Setup plot list
            figSize = obj.figureSize;
            plotList = uibuttongroup('parent',h,...
                            'Units','pixels',...
                            'Position',[10 10  150 figSize(4)-45],...
                            'tag','plotList',...
                            'SelectionChangedFcn',@obj.selectPlot);
            set(plotList,'Title',p.Results.listName);
            
            % Menu
            plotList.UIContextMenu = uicontextmenu;
            plotList.UIContextMenu.UserData = plotList;
            uimenu(plotList.UIContextMenu,'Label','Add Plot','Callback',@obj.addPlot);
            uimenu(plotList.UIContextMenu,'Label','Add Table','Callback',@obj.addTable);
            uimenu(plotList.UIContextMenu,'Label','Add Label','Callback',@obj.addLabel);
            uimenu(plotList.UIContextMenu,'Label','Rename','Callback',@obj.renameDlg,'Separator','on');
            h.UserData = plotList;
            if(length(plotList.Children) <= 1)
                plotList.Visible = 'off';
            end
            % Make the new tab current
            obj.tabGroup.SelectedTab = h;
        end
        function ha = addPlot(obj,varargin)
        %% addPlot 
        % Adds a plot to the given tab.  
        %  When the plot button is selected the plot is selected
        %
        % ha = h.addPlot([title],'tab',[h_tab],'plotFcn',[function_handle])
        %
        % INPUTS
        %  title - (optional) Uses this string as the plot title displayed 
        %   in the plot list
        % PARAMETERS
        %  tab - Selects which tab will contain the table.  The tab can be
        %   specified as a uitab handle or the name of the tab
        %  plotFcn - A function handle to be evaluated when the plot is
        %   selected.
        % OUTPUTS
        %  ha - Handle to the plot axis
        % EXAMPLE
        %  h = tfigure;
        %  ha = h.addPlot('Plot Title');
        % 
        % see also: tfigure, tfigure.tfigure, tfigure.addTab,
        % tfigure.addTable
        if(~isempty(varargin) && ~isa(varargin{1},'matlab.ui.container.Menu'))
            p=inputParser;
            p.addOptional('title','plot',@ischar)
            p.addParameter('plotFcn',[],@(x) (isa(x,'function_handle') || isempty(x)));
            p.addParameter('tab',obj.tabGroup.SelectedTab,@(x) (isa(x,'double') || isa(x,'matlab.ui.container.Tab') || ischar(x)));
            p.addParameter('order',[],@isnumeric);
            p.parse(varargin{:})
        else
            p.Results.tab = obj.tabGroup.SelectedTab;
            p.Results.plotFcn = [];
            p.Results.title = 'plot';
            p.Results.order = [];
        end
            % Select the Tab
            tab = obj.parseTab(p.Results.tab);
            
            % Add the new analysis panel to the plot list
            plotList = get(tab,'UserData'); % The tab's UserData contains a handle to the uibuttongroup for the tab
            h = uicontrol('parent',plotList,...
                          'Style', 'togglebutton',...
                          'String', p.Results.title,'Units','pixels',...
                          'tag','plot');
                      
            % Setup Context Menu
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,'Label','Rename','Callback',@obj.renameDlg);
            uimenu(c,'Label','Delete','Callback',@obj.deleteDlg);
            exportMenu = uimenu('Parent',c,'Label','Export');
            uimenu(exportMenu,'Label','Copy to Clipboard','Callback',@obj.exportToClipboard);
            uimenu(exportMenu,'Label','Copy to Figure','Callback',@obj.exportToFigure);
            % Setup Panel
            h.UserData.hp = uipanel('Parent',tab,'Units','pixels',...
                                    'tag','plot','BorderType','none');
            h.UserData.hp.UserData.hc = h;

            % Setup Axes
            ha = axes(h.UserData.hp);%,...'Units','pixels',...
%                              'ActivePositionProperty','OuterPosition');
            ha.Visible = 'on';
            
            % Setup order
            plotList.Children = tfigure.childReorder(plotList.Children,p.Results.order);
            
            if(~isempty(p.Results.plotFcn))
                h.UserData.fh = p.Results.plotFcn;
                p.Results.plotFcn();
            else
                h.UserData.fh = [];
            end
            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);
        end
        function varargout = addTable(obj,varargin)
        %% addTable
        % Adds a table to the given tab.
        %
        % ht = h.addTable([title],'Param','ParamValue',...)
        %
        % INPUTS
        %  title - (optional) The table title to displayed on the selection
        %   button
        % PARAMETERS
        %  tab - Selects which tab will contain the table.  The tab can be
        %   specified as a uitab handle or the name of the tab
        %  order - Position in the plot list
        %  style - Selects between the default MATLAB table and a Java
        %   table. uitable: 'uitable or 'ui'  Java Table: 'Java',
        %   'JavaTable'
        % OUTPUTS
        %  ht - handle to the table
        %
        % See also: tfigure.addPlot tfigure.addLabel tfigure.addCtrl
        if(~isempty(varargin) && ~isa(varargin{1},'matlab.ui.container.Menu'))
            p=inputParser;
            p.addOptional('title','table',@ischar)
            p.addParameter('tab',obj.tabGroup.SelectedTab,@(x) (isa(x,'double') || isa(x,'matlab.ui.container.Tab') || ischar(x)))
            p.addParameter('order',[],@isnumeric);
            p.addParameter('style','uitable',...
                @(x) any(validatestring(x,{'uitable','ui','JavaTable','Java'})))
            p.parse(varargin{:})
        else
            p.Results.tab = obj.tabGroup.SelectedTab;
            p.Results.title = 'table';
            p.Results.order = [];
            p.Results.style = 'uitable';
        end
            % Select the Tab
            tab = obj.parseTab(p.Results.tab);
            
            % Add the new plot to the plot list
            plotList = get(tab,'UserData'); % The tab's UserData contains a handle to the uibuttongroup for the tab
            h = uicontrol('parent',plotList,...
                            'Style', 'togglebutton',...
                            'String', p.Results.title,'Units','pixels',...
                            'tag','table');
%             h.UserData = p.Results.fun_handle;
            
            % Setup Context Menu
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,'Label','Rename','Callback',@obj.renameDlg);
            uimenu(c,'Label','Delete','Callback',@obj.deleteDlg);
            
            % Setup Panel
            h.UserData.hp = uipanel('Parent',tab,'Units','pixels',...
                                    'tag','plot','BorderType','none');
            h.UserData.hp.UserData.hc = h;
            h.UserData.fh = [];
            
            % Setup Table
            if(strcmpi(p.Results.style,'uitable') || strcmpi(p.Results.style,'ui'))
                ht = uitable('Parent',h.UserData.hp,'Units','normalized','Position',[0 0 1 1]);%,'Units','pixels');
            elseif(strcmpi(p.Results.style,'JavaTable') || strcmpi(p.Results.style,'java'))
                if(~(exist('exportToPPTX','file')))
                    error('tfigure:NeedExportToPPTX',...
                         ['createTable must be added to the path. ',...
                        'It can be downloaded from the MATLAB file exchange, search for "Java-based data table"']);
                end
                ht = uiextras.jTable.Table('Parent',h.UserData.hp);
            end
            %             h.UserData.fa.Visible = 'on';   
            h.UserData.hp.UserData.hc = ht;
            
            % Setup order
            plotList.Children = tfigure.childReorder(plotList.Children,p.Results.order);
            
            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);
            
            % Setup outputs
            if(nargout == 0)
                varargout = {};
            elseif(nargout == 1)
                varargout = {ht};
            elseif(nargout == 2)
                varargout = {ht h};
            else
                error('tfigure:addTable:nargoutWrong','The number of outputs must be 0-2');
            end
        end
        function h = addLabel(obj,varargin)
        %% addLabel Adds a label to the plot list
        %
        %  hl = h.addLabel(title,[tab],...)
        %  
        % INPUTS
        %  title - text to display
        % PARAMETERS
        %  title - text to display
        %  order - Position in the plot list
        %  tab - Selects which tab will contain the table.  The tab can be 
        %   specified as a uitab handle or the name of the tab 
        % OUTPUTS
        %  hl - label handle
        %
        % see also: tfigure, tfigure.tfigure, tfigure.addTab,
        % tfigure.addTable
            if(~isempty(varargin) && ~isa(varargin{1},'matlab.ui.container.Menu'))
                p=inputParser;
                p.addRequired('title',@ischar);
                p.addParameter('tab',obj.tabGroup.SelectedTab,@(x) (isa(x,'double') || isa(x,'matlab.ui.container.Tab') || ischar(x)))
                p.addParameter('order',[],@isnumeric);
                p.parse(varargin{:})
            else
                p.Results.title = inputdlg('Label:','Label',1,{''});
                p.Results.tab = obj.tabGroup.SelectedTab;
                p.Results.order = [];
            end
            
            % Select the Tab
            tab = obj.parseTab(p.Results.tab);
            
            % Add the new label to the plot list
            plotList = get(tab,'UserData'); % The tab's UserData contains a handle to the uibuttongroup for the tab
            h = uicontrol('parent',plotList,...
                          'Style', 'text',...
                          'String', p.Results.title,'Units','pixels',...
                          'tag','label');
            
            % Setup Context Menu
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,'Label','Rename','Callback',@obj.renameDlg);
            uimenu(c,'Label','Delete','Callback',@obj.deleteDlg);
            
            % Setup order
            plotList.Children = tfigure.childReorder(plotList.Children,p.Results.order);
            
            obj.selectPlot(plotList,[]);
        end
        function h = addCtrl(obj,varargin)
        %% addCtrl
        % Adds a control panel to a tab
        %  Requires a fun_handle which points to the control panel function
        %  which defines its contents
        %
        %  hp = h.addCtrl([title],[fun_handle(h_panel)],'Param','value') 
        % INPUTS
        %  title - (optional) text of the control's plot list button
        %  fun_handle - (optional) A function that defines the control panel.  It has 
        %   a single input that is a handle to the panel that will contain 
        %   the control panel.
        % PARAMETERS
        %  order - Position in the plot list
        %  tab - Selects which tab will contain the table.  The tab can be 
        %   specified as a uitab handle or the name of the tab 
        % OUTPUTS
        %   hp - handle for the control panel's plot list button
        %
        % See also: tfigure, tfigure.tfigure
            p=inputParser;
            p.addOptional('title','Options',@ischar);
            p.addOptional('fun_handle',[],@(x) isa(x,'function_handle'));
            p.addParameter('tab',obj.tabGroup.SelectedTab,@(x) (isa(x,'double') || isa(x,'matlab.ui.container.Tab') || ischar(x)));
            p.addParameter('order',[],@isnumeric);
            p.parse(varargin{:});
            
            % Select the Tab
            tab = obj.parseTab(p.Results.tab);
            
            % Add the new control panel to the plot list
            figSize = obj.figureSize;
            plotList = get(tab,'UserData'); % The tab's UserData contains a handle to the uibuttongroup for the tab
            h = uicontrol('parent',plotList,...
                          'Style', 'togglebutton',...
                          'String', p.Results.title,'Units','pixels',...
                          'tag','ctrl');
            % Setup Control Panel
            h_panel = uipanel('Parent',tab,...
                              'Units','pixels',...
                              'Position',[30 30  figSize(3)-30 figSize(4)-30],...
                              'tag','ctrl',...
                              'Title',p.Results.title);
            h.UserData.hp = h_panel;
            
            % Setup Context Menu
            c = uicontextmenu;
            c.UserData = h;
            h.UIContextMenu = c;
            uimenu(c,'Label','Rename','Callback',@obj.renameDlg);
            uimenu(c,'Label','Delete','Callback',@obj.deleteDlg);
%             h.UserData.fa = axes('Parent',tab,'Units','pixels',...
% ...%                              'position',axesSize,...
%                              'ActivePositionProperty','OuterPosition');
%             h.UserData.fa.Visible = 'on';           

            % Setup order
            plotList.Children = tfigure.childReorder(plotList.Children,p.Results.order);

            if(~isempty(p.Results.fun_handle))
                h.UserData.fh = p.Results.fun_handle;
                p.Results.fun_handle(h_panel);
            end
            plotList.SelectedObject = h;
            obj.selectPlot(plotList,[]);
        end
        %function export(obj,varargin)
        % export Exports an analysis panel, a tab, or an entire tfigure using
        % the specified format
        %
        % Not currently implemented
        %end
        function exportToClipboard(obj,varargin)
        %% exportToClipboard 
        % Exports a panel to the clipboard as if it it were in its own 
        % figure
        %
        % obj.exportToClipboard([panel]
        %
        % INPUTS
        %  panel - (optional) a panel handle to be exported
        %   Uses the current panel (obj.gcp) by default
        %
        % See also: tfigure, tfigure.tfigure
            if(nargin == 2)
                p = inputParser;
                p.addOptional('panel',obj.gcp,@(x) strcmp(x.Type,'uipanel'))
                p.parse(varargin{:});
            elseif(nargin == 3)
                if(~isempty(varargin{1}.Parent.UserData) && strcmp(varargin{1}.Parent.UserData.Type,'uicontrol'))
                    p.Results.panel = varargin{1}.Parent.UserData.UserData.hp;
                else
                    p.Results.panel = obj.gcp;
                end
            else
                p.Results.panel = obj.gcp;
            end

            % Copy the panel to a seperate figure and copy tp clipboard
            hf = figure('Visible','off','Color','w');
            hp = copy(p.Results.panel);
            hp.Parent = hf;
            hp.BackgroundColor = 'w';
            hp.Units = 'normalized';
            hp.Position = [0 0 1 1];
            hp.Visible = 'on';
            print(hf,'-clipboard','-dbitmap')
            close(hf);
        end
        function varargout = exportToFigure(obj,varargin)
        % exportToFigure Copies a panel to a new figure
        % 
        % USAGE:
        %  hf = h.exportToFigure
        %  hf = exportToFigure(h)
        %   Copies current panel (h.gcp) to a new figure with handle hf
        %  hf = h.exportToFigure(panel)
        %   Copies panel (panel) to a new figure with handle hf
        %
        % INPUTS
        %  panel - (optional) a panel handle to be exported
        %   Uses the current panel (obj.gcp) by default
        % OUTPUTS
        %  hf - a handle to the newly created figure
        %
        % See also: tfigure, tfigure.tfigure
            if(nargin == 1)
                panel = obj.gcp;
            elseif(isa(varargin{1},'matlab.ui.container.Panel'))
                panel = varargin{1};
            elseif(nargin == 3 && isa(varargin{1},'matlab.ui.container.Menu'))
            % Callback
                panel = varargin{1}.Parent.Parent.UserData.UserData.hp;
            else
                panel = obj.gcp;
            end
            
            if(nargin>2 && ~isa(varargin{1},'matlab.ui.container.Menu'))
                h = figure(varargin{2:end});
            else
                h = figure;
            end
            hp = copy(panel);
            hp.Units = 'normalized';
            hp.Position = [0 0 1 1];
            hp.Parent = h;
            hp.Visible = 'on';
            if(nargout == 1)
                varargout{1} = h;
            elseif(nargout == 2)
                varargout = {h hp};
            end
        end
        function savePPT(obj,varargin)
        %% savePPT 
        % Saves all the plots in tfigure to a powerpoint presentation.  
        % 
        % h.savePPT(...)
        %  Brings up a file selection dialog
        % h.savePPT(fileName,...)
        %
        % FILENAME
        %  fileName - file name of the file to save the plots
        % PARAMETERS:
        %  title - Title of the presentation
        %  subject - subject of presentation, included in file meta data
        %  comments - comments on the presentation
        %  author - Author's name
        %
        % See also: tfigure, tfigure.tfigure
            if(~(exist('exportToPPTX','file')))
               error('tfigure:NeedExportToPPTX',...
                     ['exportToPPTX must be added to the path. ',...
                     'It can be downloaded from the MATLAB file exchange']);
            end
            if(~isempty(obj.fig.Name))
                figTitle = obj.fig.Name;
            else
                figTitle = ['Figure ' num2str(obj.fig.Number) ' Data'];
            end
            p = inputParser;
            p.addOptional('fileName','',@ischar);
            p.addParameter('title',figTitle);
            p.addParameter('author','');
            p.addParameter('subject','');
            p.addParameter('comments','');
            p.parse(varargin{:});
            if(isempty(p.Results.fileName))
                [fileName,pathname] = uiputfile('.pptx','Export PPTX: select a file name');
                if(fileName ~= 0)
                    fileName = fullfile(pathname,fileName);
                else
                    return
                end
            else
                fileName = p.Results.fileName;
            end
            isOpen  = exportToPPTX();
            if ~isempty(isOpen),
                % If PowerPoint already started, then close first and then open a new one
                exportToPPTX('close');
            end
            exportToPPTX('new',... %'Dimensions',[12 6], ...
                         'Title',p.Results.title, ...
                         'Author',p.Results.author, ...
                         'Subject',p.Results.subject, ...
                         'Comments',p.Results.comments);
            exportToPPTX('addslide');
            exportToPPTX('addtext',p.Results.title,...
                         'HorizontalAlignment','center',...
                         'VerticalAlignment','middle','FontSize',48);
            for tabNum = 1:length(obj.tabs)
                ht = obj.tabs(tabNum);
%                 hp = findobj(ht.Children,'tag','plot');
                exportToPPTX('addslide');
                exportToPPTX('addtext',ht.Title,...
                             'HorizontalAlignment','center',...
                             'VerticalAlignment','middle','FontSize',48);
                panels = [ht.UserData.Children.UserData];
                panels = [panels.hp];
                for panelNum = 1:length(panels)
                    [h hp] = obj.exportToFigure(panels(panelNum),'Visible','off');
                    hp.BackgroundColor = 'w';
                    exportToPPTX('addslide');
                    exportToPPTX('addpicture',h,'Scaled','maxfixed');
                    close(h);
                end
            end
            exportToPPTX('save',fileName);
            exportToPPTX('close');
        end
        function out = get.figureSize(obj)
            out = get(obj.fig,'position');
        end
        function set.figureSize(obj,val)
            set(obj.fig,'position',val);
        end
        function h = get.gct(obj)
        % gct Get Current Tab
        %  Returns the handle to the current tab
        h = obj.tabGroup.SelectedTab;
        end
        function h = get.gcp(obj)
        % gcp Get Current Panel
        %  Returns the handle to the current tab
            if(~isempty(obj.gct.UserData.SelectedObject))
                h = obj.gct.UserData.SelectedObject.UserData.hp;
            else
                h = [];
            end
        end
        function t = get.tabs(obj)
            t = obj.tabGroup.Children(1:end-1);
        end
%         function set.tabs(obj,in)
%             obj.tabs = [in obj.tabs(end)]
%         end
    end
    methods (Access = private)
        function figResize(obj,src,~) % callbackdata is unused 3rd arg.
        % figResize Resizes the gui elements in each tab whenever the 
        %  figure is resized. 
            figSize = obj.figureSize;
            
            % Set minimum figure size
%             if(figSize(3)<560)
%                 figSize(3) = 560;
%             end
%             if(figSize(4)<420)
%                 figSize(4) = 420;
%             end
%             obj.figureSize = figSize;
            
            % Find selected tab and plot
%             currTab = obj.tabGroup.SelectedTab;
            if(~isempty(obj.gct.UserData.SelectedObject))
                numPlots = length(obj.gct.UserData.Children);
            else
                numPlots = 0;
            end
            
            % Plot list adjustment
            if(numPlots==1)
                plotListAdj = [-160 0 150 0];
            else
                plotListAdj = [0 0 0 0];
            end

            %Resize Current "Axes"
            if(strcmp(get(obj.gcp,'tag'),'ctrl')) % Resize ctrl panels
                set(obj.gcp,'Units','pixels','Position',[170 10  figSize(3)-185 figSize(4)-45]...
                                                   ...%- [0 0 ceil(leg_pos(3)) 0]... % Legend Adjustment
                                                   + plotListAdj); % Plot list adjustment
            else % Resize Axes
            set(obj.gcp,'Units','pixels','Position',[170 10  figSize(3)-185 figSize(4)-45]...
                                                   ...%- [0 0 ceil(leg_pos(3)) 0]... % Legend Adjustment
                                                   + plotListAdj); % Plot list adjustment
            end
            % Resize the plot list
            plots = obj.gct.UserData.Children;
            for n = 1:length(plots)
                set(plots(n),'Position',[10 figSize(4)-85-30*(n-1) 120 20]);
            end

            % Resize each list of plots
            plotLists = findobj(src,'tag','plotList','-and',...
                                'Type','uibuttongroup');
            set(plotLists,'Units','pixels','Position',[10 10  150 figSize(4)-45]);
        end
        function selectPlot(obj,src,~) % ~ is callbackdata          
        % selectPlot Runs whenever a plot is selected from the plot list
            if(length(src.Children) > 1)
                h_panels = [src.Children.UserData];
                h_panels = [h_panels.hp];
                set(h_panels,'visible','off')
                
                src.SelectedObject.UserData.hp.Visible = 'on';
                src.Visible = 'on';
                if(~isempty(findobj(src.SelectedObject.UserData.hp.Children,'Type','axes')))
                    axes(findobj(src.SelectedObject.UserData.hp.Children,'Type','axes'));
                end
            end
            obj.figResize(obj.fig);
        end
        function selectTab(obj,b,c)
            obj.figResize(obj.fig);
            if(~isempty(obj.gcp) && ...
               ~isempty(findobj(obj.gcp.Children,'Type','axes')))
                axes(findobj(obj.gcp.Children,'Type','axes'));
            end
        end
        function tab_out = parseTab(obj,tab)
        % parseTab - parses a tab input, creating a new tab if the tab
        %  input is a tab name that doesn't exist.  Can accept a handle or
        %  a string input of the tab name.
            if(ischar(tab))
                tab_obj = findobj(obj.tabs,'Type','uitab','Title',tab);
                if(isempty(tab_obj))
                    tab_out = obj.addTab(tab);
                else
                    tab_out = tab_obj;
                end
            else
                tab_out = tab;
            end
        end
        function exportMenu(obj,menu,~)
        % Export menu callback
        %  Executes the requested depending on the selected export option
            if(strcmp(menu.Label,'Export PPT'))
                obj.savePPT();
            end
        end    
        function renameDlg(~,menu,~) % ~ is obj, ActionData
        % renameDlg Diaglog box for renaming plots and tabs from a context
        %  menu
            type = get(menu.Parent.UserData,'Type');
            if(strcmpi(type,'uicontrol'))
                prevName = {menu.Parent.UserData.String};
                % Get new name from the user
                newName = inputdlg('New Name:','Rename',1,prevName);
                if(~isempty(newName))
                    menu.Parent.UserData.String = newName{1};
                end
            elseif(any(strcmpi(type, {'uitab','uibuttongroup'})))
                prevName = {menu.Parent.UserData.Title};
                % Get new name from the user
                newName = inputdlg('New Name:','Rename',1,prevName);
                if(~isempty(newName))
                    menu.Parent.UserData.Title = newName{1};
                end
            else
                error('tfigure:renameDlg:unknownSelectionType',...
                      'unknown selection type, need to add ui type to be renamed to the callback function');
            end
        end
        function deleteDlg(obj,menu,~)
        % deleteDlg function for deleting tabs and plots.  Double checks
        % with the user if a plot already exists.
        %  menu
%         h = warndlg(['The tab "'
%             h_dlg = warndlg({'The following tab will be deleted:'; menu.Parent.UserData.Title}, 'Delete Tab Warning','modal');
%             choice = questdlg({'The following tab will be deleted:'; menu.Parent.UserData.Title},'Delete Warning','OK','cancel','cancel')
%             switch choice
%                 case 'OK'
%             if(find(menu.UserData.Parent.Children == menu.UserData)  == length(menu.UserData.Parent.Children)-1)
%                 selectPrevTabFcn = menu.UserData.Parent.Children(end-2).ButtonDownFcn;
%             else
%                 selectPrevTabFcn = @(x)(1);
%             end
            delete(menu.Parent.UserData);
            if(length(obj.gct.Parent.Children)>1 && find(obj.gct == obj.gct.Parent.Children) == length(obj.gct.Parent.Children))
                obj.gct.Parent.SelectedTab = obj.gct.Parent.Children(end-1);
            end
%             selectPrevTabFcn();
%             end
            
%             x =0;
%             if(isvalid(h_dlg))
%                 delete(menu.Parent.UserData);
%             end
%             type = get(menu.Parent.UserData,'Type');
%             if(strcmpi(type,'uicontrol'))
%                 
%             else
%                 
%             end
        end
    end
    methods (Access = private, Static = true)
        function children = childReorder(children,order)
        % childReorder reorders the children of tabs or plot lists
        %
        % INPUTS
        %  children - 
        %  Order - sets the an integer between 1 and length(children)+1 that 
        %  specifies its index.  If order is empty, the first child is 
        %  moved to the last child
        %
        %
            if(isempty(order) || (order >= length(children)+1))
                children = children([2:end 1]);
            elseif((order > 1) && (order < length(children)))
                children = children([2:order 1 (order+1):end]);
            end
        end
    end
end


##### SOURCE END #####
--></body></html>